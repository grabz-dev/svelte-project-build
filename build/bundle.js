var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function l(t,e,n){t.$$.on_destroy.push(r(e,n))}function a(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function m(){return p(" ")}function g(){return p("")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}function y(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}let x,b;function k(){if(void 0===x){x=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){x=!0}}return x}function z(t,e,n){t.classList[n?"add":"remove"](e)}function C(t){b=t}function M(t){(function(){if(!b)throw new Error("Function called outside component initialization");return b})().$$.on_mount.push(t)}const _=[],A=[],E=[],O=[],S=Promise.resolve();let q=!1;function I(t){E.push(t)}const P=new Set;let B=0;function T(){const t=b;do{for(;B<_.length;){const t=_[B];B++,C(t),j(t.$$)}for(C(null),_.length=0,B=0;A.length;)A.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];P.has(e)||(P.add(e),e())}E.length=0}while(_.length);for(;O.length;)O.pop()();q=!1,P.clear(),C(t)}function j(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const D=new Set;let Y;function L(){Y={r:0,c:[],p:Y}}function X(){Y.r||o(Y.c),Y=Y.p}function F(t,e){t&&t.i&&(D.delete(t),t.i(e))}function R(t,e,n,o){if(t&&t.o){if(D.has(t))return;D.add(t),Y.c.push((()=>{D.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}const N="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function W(t){t&&t.c()}function U(t,n,s,r){const{fragment:l,on_mount:a,on_destroy:c,after_update:u}=t.$$;l&&l.m(n,s),r||I((()=>{const n=a.map(e).filter(i);c?c.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(I)}function H(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function J(t,e){-1===t.$$.dirty[0]&&(_.push(t),q||(q=!0,S.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(e,i,s,r,l,a,c,d=[-1]){const f=b;C(e);const p=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(f?f.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:i.target||f.$$.root};c&&c(p.root);let m=!1;if(p.ctx=s?s(e,i.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return p.ctx&&l(p.ctx[t],p.ctx[t]=i)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](i),m&&J(e,t)),n})):[],p.update(),m=!0,o(p.before_update),p.fragment=!!r&&r(p.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();i.intro&&F(e.$$.fragment),U(e,i.target,i.anchor,i.customElement),T()}C(f)}class G{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Q=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={},i=function(){return new Map};if("undefined"==typeof Map){var s=function(){this.data={}};s.prototype.get=function(t){return this.data.hasOwnProperty(t)?this.data[t]:null},s.prototype.set=function(t,e){this.data[t]=e},s.prototype.has=function(t){return this.data.hasOwnProperty(t)},s.prototype.delete=function(t){delete this.data[t]},i=function(){return new s}}function r(t,e){if(!o[t]){o[t]={};for(var n=0;n<t.length;n++)o[t][t[n]]=n}return o[t][e]}var l={compressToBase64:function(t){if(null==t)return"";var n=l._compress(t,6,(function(t){return e.charAt(t)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:l._decompress(t.length,32,(function(n){return r(e,t.charAt(n))}))},compressToUTF16:function(e){return null==e?"":l._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:l._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=l.compress(t),n=new Uint8Array(2*e.length),o=0,i=e.length;o<i;o++){var s=e.charCodeAt(o);n[2*o]=s>>>8,n[2*o+1]=s%256}return n},decompressFromUint8Array:function(e){if(null==e)return l.decompress(e);for(var n=new Array(e.length/2),o=0,i=n.length;o<i;o++)n[o]=256*e[2*o]+e[2*o+1];var s=[];return n.forEach((function(e){s.push(t(e))})),l.decompress(s.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":l._compress(t,6,(function(t){return n.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),l._decompress(t.length,32,(function(e){return r(n,t.charAt(e))})))},compress:function(e){return l._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,n){if(null==t)return"";var o,s,r,l=i(),a=i(),c="",u="",d="",f=2,p=3,m=2,g=[],h=0,$=0;for(r=0;r<t.length;r+=1)if(c=t[r],l.has(c)||(l.set(c,p++),a.set(c,!0)),u=d+c,l.has(u))d=u;else{if(a.has(d)){if(d.charCodeAt(0)<256){for(o=0;o<m;o++)h<<=1,$==e-1?($=0,g.push(n(h)),h=0):$++;for(s=d.charCodeAt(0),o=0;o<8;o++)h=h<<1|1&s,$==e-1?($=0,g.push(n(h)),h=0):$++,s>>=1}else{for(s=1,o=0;o<m;o++)h=h<<1|s,$==e-1?($=0,g.push(n(h)),h=0):$++,s=0;for(s=d.charCodeAt(0),o=0;o<16;o++)h=h<<1|1&s,$==e-1?($=0,g.push(n(h)),h=0):$++,s>>=1}0==--f&&(f=Math.pow(2,m),m++),a.delete(d)}else for(s=l.get(d),o=0;o<m;o++)h=h<<1|1&s,$==e-1?($=0,g.push(n(h)),h=0):$++,s>>=1;0==--f&&(f=Math.pow(2,m),m++),l.set(u,p++),d=String(c)}if(""!==d){if(a.has(d)){if(d.charCodeAt(0)<256){for(o=0;o<m;o++)h<<=1,$==e-1?($=0,g.push(n(h)),h=0):$++;for(s=d.charCodeAt(0),o=0;o<8;o++)h=h<<1|1&s,$==e-1?($=0,g.push(n(h)),h=0):$++,s>>=1}else{for(s=1,o=0;o<m;o++)h=h<<1|s,$==e-1?($=0,g.push(n(h)),h=0):$++,s=0;for(s=d.charCodeAt(0),o=0;o<16;o++)h=h<<1|1&s,$==e-1?($=0,g.push(n(h)),h=0):$++,s>>=1}0==--f&&(f=Math.pow(2,m),m++),a.delete(d)}else for(s=l.get(d),o=0;o<m;o++)h=h<<1|1&s,$==e-1?($=0,g.push(n(h)),h=0):$++,s>>=1;0==--f&&(f=Math.pow(2,m),m++)}for(s=2,o=0;o<m;o++)h=h<<1|1&s,$==e-1?($=0,g.push(n(h)),h=0):$++,s>>=1;for(;;){if(h<<=1,$==e-1){g.push(n(h));break}$++}return g.join("")},decompress:function(t){return null==t?"":""==t?null:l._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,n,o){var s,r,l,a,c,u,d,f=i(),p=4,m=4,g=3,h="",$=[],v={val:o(0),position:n,index:1};for(s=0;s<3;s+=1)f.set(s,s);for(l=0,c=Math.pow(2,2),u=1;u!=c;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),l|=(a>0?1:0)*u,u<<=1;switch(l){case 0:for(l=0,c=Math.pow(2,8),u=1;u!=c;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),l|=(a>0?1:0)*u,u<<=1;d=t(l);break;case 1:for(l=0,c=Math.pow(2,16),u=1;u!=c;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),l|=(a>0?1:0)*u,u<<=1;d=t(l);break;case 2:return""}for(f.set(3,d),r=d,$.push(d);;){if(v.index>e)return"";for(l=0,c=Math.pow(2,g),u=1;u!=c;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),l|=(a>0?1:0)*u,u<<=1;switch(d=l){case 0:for(l=0,c=Math.pow(2,8),u=1;u!=c;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),l|=(a>0?1:0)*u,u<<=1;f.set(m++,t(l)),d=m-1,p--;break;case 1:for(l=0,c=Math.pow(2,16),u=1;u!=c;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=o(v.index++)),l|=(a>0?1:0)*u,u<<=1;f.set(m++,t(l)),d=m-1,p--;break;case 2:return $.join("")}if(0==p&&(p=Math.pow(2,g),g++),f.get(d))h=f.get(d);else{if(d!==m)return null;h=r+r[0]}$.push(h),f.set(m++,r+h[0]),r=h,0==--p&&(p=Math.pow(2,g),g++)}}};return l}();function V(t){let e=t;const n=[],o=t=>{e=t,n.forEach((t=>t(e)))};return{subscribe:t=>(n.push(t),t(e),()=>{const e=n.findIndex((e=>e===t));n.splice(e,1)}),set:o,update:t=>o(t(e)),get:()=>e}}function Z(t,e){return Math.floor(Math.random()*(e-t))+t}"function"==typeof define&&define.amd?define((function(){return Q})):"undefined"!=typeof module&&null!=module&&(module.exports=Q);var tt=()=>{const t=mt.get().battle,e=mt.get().player,n=mt.get().inventories.equipment;function o(e){const n=t.grid.get()[t.grid.get().length-2].get().filter((t=>{const e=t.get().enemy;return null!=e&&!1===e.get().dead}));if(0===n.length)return;n[Z(0,n.length)].get().enemy.update((t=>(t.healthCur-=e,t.healthCur<=0&&(t.healthCur=0,t.dead=!0),t)))}function i(){const t=[];for(let e=0;e<6;e++){let n=V({enemy:null});if(Math.random()<.05){const t=Z(10,100);n.update((e=>{let n=V({healthCur:t,healthMax:t,damage:Z(1,4),attackClock:0,attackInterval:Z(1e3,5e3),dead:!1});return e.enemy=n,e}))}t[e]=n}return t}function s(){const e=t.grid.get()[t.grid.get().length-2];for(const t of e.get()){const e=t.get().enemy;if(null!=e&&!e.get().dead)return!1}return!0}return{fixedUpdate:function(r){t.initialized.get()||(t.initialized.set(!0),t.grid.set(function(){let t=[];for(let e=0;e<8;e++)t[e]=V(i());return t}()),t.distance.set(1),e.y.set(0),e.acceleration.set(.5),e.speed.set(.5)),e.healthCur.get()>0&&function(r){e.moving.get()||s()&&e.moving.set(!0);let l=!1;e.moving.get()&&(t.distance.get()>e.y.get()&&(e.y.update((t=>t+r/1e3*e.speed.get())),e.speed.update((t=>t+e.acceleration.get()/r))),e.y.get()>=t.distance.get()&&(t.distance.update((t=>t+1)),t.grid.update((t=>(t.splice(t.length-1),t.unshift(V(i())),t))),l=!0,s()||e.moving.set(!1)));for(const t of n.get()){const n=t.get().item;if(null==n)continue;const o=n.get(),i=o.tags.weapon;i&&i.attackClock<i.attackInterval&&(i.attackClock+=r,i.attackClock>i.attackInterval&&e.moving.get()&&(i.attackClock=i.attackInterval),n.set(o))}if(!e.moving.get()){for(const t of n.get()){const e=t.get().item;if(null==e)continue;const n=e.get(),i=n.tags.weapon;i&&(i.attackClock>=i.attackInterval&&(i.attackClock-=i.attackInterval,i.attack&&o(i.attack)),e.set(n))}l&&(s()?e.moving.set(!0):(e.y.set(t.distance.get()-1),e.speed.set(1)))}}(r)}}};const et={battle:null,player:null,inventory:null,windows:null},nt=[],ot=[],it=t=>null!=t.fixedUpdate,st=t=>null!=t.init;let rt=0,lt=0;function at(t){for(lt+=t-rt,rt=t;lt>=ft.frameTime;)lt-=ft.frameTime,ct(ft.frameTime);(function(t){let e;return r(t,(t=>e=t))(),e})(mt.get().stats.timeToNextSave)<=0&&gt(),requestAnimationFrame(at)}function ct(t){mt.get().stats.timeElapsedSession.update((e=>e+t)),mt.get().stats.timeElapsedTotal.update((e=>e+t)),mt.get().stats.timeToNextSave.update((e=>e-t));for(const e of nt)e.fixedUpdate(t)}function ut(){et.battle=tt(),et.player=(()=>{const t=mt.get().player,{equipment:e}=mt.get().inventories;function n(){var n,o;let i=0,s=0;for(const t of e.get()){const e=t.get().item;if(null==e)continue;const r=e.get();null!=r.tags.armor&&(i+=null!==(n=r.tags.armor.health)&&void 0!==n?n:0,s+=null!==(o=r.tags.armor.block)&&void 0!==o?o:0)}t.healthMax.set(i),t.healthMax.get()>i&&t.healthCur.set(i),t.block.set(s)}return{init:function(){for(const t of e.get())t.subscribe(n)}}})(),et.inventory=(()=>{function t(t){const e=t.get(),n=e.tags.weapon;null!=n&&n.attackClock>0&&(n.attackClock=0,t.set(e))}return{itemAt:function(t,e){const n=t.get()[e];if(null==n)return null;const o=n.get().item;return null==o?null:o},add:function(t,e,n){const o=null==n?function(t){for(const[e,n]of t.get().entries())if(null==n.get().item)return e;return null}(t):n;if(null==o)return!1;const i=t.get()[o];return!(null==i||null!=i.get().item||i.get().types.length>0&&!i.get().types.includes(e.type)||(i.update((t=>(t.item=V(e),t))),0))},remove:function(t,e){const n=t.get()[e];return null!=n&&null!=n.get().item&&(n.update((t=>(t.item=null,t))),!0)},transfer:function(e,n,o,i){const s=n.get().findIndex((t=>t.get().item===e));if(-1===s)return!1;const r=n.get()[s],l=o.get()[i];if(null==l)return!1;const a=l.get().item;return!(null!=a&&r.get().types.length>0&&!r.get().types.includes(a.get().type)||l.get().types.length>0&&!l.get().types.includes(e.get().type)||(t(e),a&&t(a),r.update((t=>(t.item=a,t))),l.update((t=>(t.item=e,t))),0))}}})(),et.windows=(()=>{const t=mt.get().windows;function e(e,n){n&&t.get().filter((t=>!0===t.get().selected)).forEach((t=>t.update((t=>(t.selected=!1,t))))),e.update((t=>(t.selected=n,t)))}function n(t,e){t.update((t=>(t.minimized=e,t)))}return{create:function(o,i){var s,r,l,a;const c=null!==(s=null==i?void 0:i.pos)&&void 0!==s?s:{x:300*Math.random()+100,y:300*Math.random()+100};let u=null===(r=null==i?void 0:i.resizable)||void 0===r||r;if("auto"!==o.size.x&&"auto"!==o.size.y||(u=!1),null!=o.id){const i=t.get().find((t=>t.get().id===o.id));if(null!=i)return e(i,!0),n(i,!1),!0}const d=V(Object.assign(Object.assign({},o),{selected:!1,minimized:!1,pos:c,initialPos:c,resizable:u}));return t.update((t=>(t.push(d),t))),e(d,null===(l=null==i?void 0:i.selected)||void 0===l||l),n(d,null!==(a=null==i?void 0:i.minimized)&&void 0!==a&&a),!0},remove:function(e){const n=t.get().findIndex((t=>t===e));return-1!==n&&(t.update((t=>(t.splice(n,1),t))),!0)},removeAll:function(){t.update((t=>[]))},select:function(n,o){const i=t.get().find((t=>t===n));return null!=i&&(e(i,o),!0)},deselectAll:function(){t.get().filter((t=>!0===t.get().selected)).forEach((t=>t.update((t=>(t.selected=!1,t)))))},move:function(e,n){const o=t.get().find((t=>t===e));return null!=o&&(o.update((t=>(t.pos=n,t))),!0)},minimize:function(e,o){const i=t.get().find((t=>t===e&&t.get().minimized!==o));if(null==i)return!1;n(i,o)},resize:function(e,n){const o=t.get().find((t=>t===e));return null!=o&&(o.update((t=>(t.size=n,t))),!0)}}})(),nt.splice(0,nt.length),nt.push(...Object.values(et).filter(it)),ot.splice(0,ot.length),ot.push(...Object.values(et).filter(st));for(const t of ot)t.init();console.info("Managers reinitialized.")}const dt="save",ft={version:8,itemSize:64,saveInterval:1e4,frameTime:20},pt={version:V(ft.version),stats:{timeElapsedSession:V(0),timeElapsedTotal:V(0),timeToNextSave:V(ft.saveInterval)},windows:V([]),inventories:{cursor:V([V({types:[],item:null})]),backpack:V(function(t,e){const n=[];for(let o=0;o<e;o++)n[o]=V(structuredClone(t));return n}({types:[],item:null},20)),equipment:V([V({types:["sword"],item:null}),V({types:["sword"],item:null}),V({types:["helmet"],item:null}),V({types:["chestplate"],item:null}),V({types:["boots"],item:null})])},battle:{distance:V(0),initialized:V(!1),grid:V([])},player:{moving:V(!1),y:V(0),speed:V(0),acceleration:V(0),healthCur:V(0),healthMax:V(0),block:V(0)},world:{}},mt=V(pt);function gt(){mt.get().stats.timeToNextSave.set(ft.saveInterval);const t=$t(mt.get(),{});localStorage.setItem(dt,Q.compressToBase64(JSON.stringify(t)))}function ht(t,e){let n=(()=>{let e=null!=t?t:localStorage.getItem(dt);if(null==e||0==e.length)return!1;if(e=Q.decompressFromBase64(e),null==e||0==e.length)return!1;const n=vt(JSON.parse(e),{});if(n.version.get()!=mt.get().version.get())return!1;for(let t=0;t<n.windows.get().length;t++){const e=n.windows.get()[t].get().id;"save_import"!==e&&"save_export"!==e||(n.windows.get().splice(t,1),t--)}return mt.set(n),console.info("Load from local storage %csuccessful%c.","color: green"),!0})();return e&&!n?(console.info("Soft load %cfailed%c.","color: orange"),!1):(n||(mt.set(pt),console.info("Load from local storage %cfailed%c. Starting a new game.","color: orange")),ut(),!0)}function $t(t,e){const n=Object.keys(t);for(const o of n){let n,i=!1;t[o]&&"function"==typeof t[o].get?(n=t[o].get(),i=!0):n=t[o],i?(e[o]={},null!=n&&"object"==typeof n?(e[o].$store=n instanceof Array?[]:{},e[o].$store=$t(n,e[o].$store)):e[o].$store=n):null!=n&&"object"==typeof n?(e[o]=n instanceof Array?[]:{},e[o]=$t(n,e[o])):e[o]=n}return e}function vt(t,e){const n=Object.keys(t);for(const o of n){let n,i=!1;t[o]&&null!=t[o].$store?(n=t[o].$store,i=!0):n=t[o],null!=n&&"object"==typeof n?(e[o]=n instanceof Array?[]:{},e[o]=vt(n,e[o]),i&&(e[o]=V(e[o]))):(e[o]=n,i&&(e[o]=V(n)))}return e}window.game=mt;const wt=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,yt=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,xt=function(t){t=t.replace(wt,((t,e,n,o)=>e+e+n+n+o+o));var e=yt.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:0,g:0,b:0}},bt=(()=>{let t=(t,e,n)=>(e-t)/6/n+.5,e=t=>Math.round(100*t)/100;return function(n){let o,i,s,r,l=0,a=n.r/255,c=n.g/255,u=n.b/255,d=Math.max(a,c,u),f=d-Math.min(a,c,u);return 0==f?l=r=0:(r=f/d,o=t(a,d,f),i=t(c,d,f),s=t(u,d,f),a===d?l=s-i:c===d?l=1/3+o-s:u===d&&(l=2/3+i-o),l<0?l+=1:l>1&&(l-=1)),{h:Math.round(360*l),s:e(100*r),v:e(100*d)}}})(),kt=function(t){let e=t.h/360,n=t.s/100,o=t.v/100,i=0,s=0,r=0,l=Math.floor(6*e),a=6*e-l,c=o*(1-n),u=o*(1-a*n),d=o*(1-(1-a)*n);switch(l%6){case 0:i=o,s=d,r=c;break;case 1:i=u,s=o,r=c;break;case 2:i=c,s=o,r=d;break;case 3:i=c,s=u,r=o;break;case 4:i=d,s=c,r=o;break;case 5:i=o,s=c,r=u}return{r:Math.round(255*i),b:Math.round(255*r),g:Math.round(255*s)}},zt=function(t,e,n){let o=e.h-t.h,i=o+(Math.abs(o)>180?o<0?360:-360:0);return{h:Math.round((t.h+i*n+360)%360),s:Math.round((e.s-t.s)*n+t.s),v:Math.round((e.v-t.v)*n+t.v)}};function Ct(e){let n;return{c(){n=f("div"),$(n,"class","sky svelte-m2lq24"),y(n,"background",e[0])},m(t,e){c(t,n,e)},p(t,[e]){1&e&&y(n,"background",t[0])},i:t,o:t,d(t){t&&u(n)}}}function Mt(t,e,n){let o=new Map;o.set(5.5,{colors:[xt("#0D0807"),xt("#0D0807")],brightness:.55}),o.set(7,{colors:[xt("#855256"),xt("#FF6D50")],brightness:.8}),o.set(8,{colors:[xt("#3B77B2"),xt("#82A9BB")],brightness:.95}),o.set(15,{colors:[xt("#3B77B2"),xt("#82A9BB")],brightness:.95}),o.set(18,{colors:[xt("#7595C0"),xt("#8C6E6E")],brightness:.85}),o.set(20,{colors:[xt("#4B65A8"),xt("#274371")],brightness:.75}),o.set(22,{colors:[xt("#001D54"),xt("#03224D")],brightness:.65}),o.set(23,{colors:[xt("#0D0807"),xt("#0D0807")],brightness:.55});let i="";return function t(){(function(t){let e=t.getHours()+t.getMinutes()/60,s=Array.from(o.keys());s.sort(((t,e)=>t-e));let r=0,l=0,a=0;for(let t=0,n=s.length;t<n&&(r=s[t],l=null==s[t+1]?s[0]:s[t+1],a=l<r?24:0,!(e>=r&&e<=l+a));t++);let c=o.get(r),u=o.get(l);if(!c||!u)return;let d=[],f=1-(l+a-(e<r?e+24:e))/(l+a-r);for(let t=0,e=Math.max(c.colors.length,u.colors.length);t<e;t++){let e=c.colors[t]||c.colors[c.colors.length-1],n=u.colors[t]||u.colors[u.colors.length-1],o=bt(e),i=bt(n),s=zt(o,i,f);d.push(kt(s)),u.brightness,c.brightness,c.brightness}n(0,i=`linear-gradient(${d.map((t=>`rgb(${t.r},${t.g},${t.b})`)).join(", ")})`)})(new Date(Date.now()+0)),setTimeout((()=>t()),1e3)}(),[i]}class _t extends G{constructor(t){super(),K(this,t,Mt,Ct,s,{})}}function At(e){let n,o,i,s,r,l,d,g,w,x,b=e[1].char+"",k=`${e[1].size}px`,z=`${e[2].x}px`,C=`${e[2].y}px`;return{c(){n=f("div"),o=f("div"),i=f("div"),s=f("div"),r=p(b),l=m(),d=f("div"),g=p(e[0]),$(s,"class","inner2 svelte-tzumok"),$(i,"class","inner svelte-tzumok"),$(o,"class","image svelte-tzumok"),y(o,"fontSize",k,!1),$(d,"class","name svelte-tzumok"),$(n,"class","icon svelte-tzumok"),y(n,"left",z,!1),y(n,"top",C,!1)},m(t,u){c(t,n,u),a(n,o),a(o,i),a(i,s),a(s,r),a(n,l),a(n,d),a(d,g),w||(x=h(n,"click",e[3]),w=!0)},p(t,[e]){2&e&&b!==(b=t[1].char+"")&&v(r,b),2&e&&k!==(k=`${t[1].size}px`)&&y(o,"fontSize",k,!1),1&e&&v(g,t[0]),4&e&&z!==(z=`${t[2].x}px`)&&y(n,"left",z,!1),4&e&&C!==(C=`${t[2].y}px`)&&y(n,"top",C,!1)},i:t,o:t,d(t){t&&u(n),w=!1,x()}}}function Et(t,e,n){let{name:o}=e,{icon:i}=e,{pos:s}=e,{onClick:r}=e;return t.$$set=t=>{"name"in t&&n(0,o=t.name),"icon"in t&&n(1,i=t.icon),"pos"in t&&n(2,s=t.pos),"onClick"in t&&n(4,r=t.onClick)},[o,i,s,function(t){r&&r(),t.stopPropagation()},r]}class Ot extends G{constructor(t){super(),K(this,t,Et,At,s,{name:0,icon:1,pos:2,onClick:4})}}function St(t,e,n){const o=t.slice();return o[1]=e[n],o[3]=n,o}function qt(e){let n,o;return n=new Ot({props:{name:e[1].name,icon:{size:26,char:e[1].icon},pos:{x:20,y:20+80*e[3]},onClick:e[1].onClick}}),{c(){W(n.$$.fragment)},m(t,e){U(n,t,e),o=!0},p:t,i(t){o||(F(n.$$.fragment,t),o=!0)},o(t){R(n.$$.fragment,t),o=!1},d(t){H(n,t)}}}function It(t){let e,n,o=t[0],i=[];for(let e=0;e<o.length;e+=1)i[e]=qt(St(t,o,e));const s=t=>R(i[t],1,1,(()=>{i[t]=null}));return{c(){e=f("div");for(let t=0;t<i.length;t+=1)i[t].c();$(e,"class","desktop svelte-iyuqm9")},m(t,o){c(t,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,[n]){if(1&n){let r;for(o=t[0],r=0;r<o.length;r+=1){const s=St(t,o,r);i[r]?(i[r].p(s,n),F(i[r],1)):(i[r]=qt(s),i[r].c(),F(i[r],1),i[r].m(e,null))}for(L(),r=o.length;r<i.length;r+=1)s(r);X()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)F(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)R(i[t]);n=!1},d(t){t&&u(e),d(i,t)}}}function Pt(t){return[[{name:"Backpack",icon:"B",onClick:()=>et.windows.create({id:"backpack",panel:"backpack",size:{x:352,y:306},title:"Backpack"})},{name:"Equipment",icon:"E",onClick:()=>et.windows.create({id:"equipment",panel:"equipment",size:{x:211,y:234},title:"Equipment"})},{name:"Add Weapon",icon:"AW",onClick:()=>et.inventory.add(mt.get().inventories.backpack,{name:"Sword",type:"sword",tags:{weapon:{attack:10,attackClock:0,attackInterval:Z(300,2e3)}}})},{name:"Add Armor",icon:"AA",onClick:()=>et.inventory.add(mt.get().inventories.backpack,{name:"Chestplate",type:"chestplate",tags:{armor:{block:5,health:30}}})},{name:"Debug",icon:"D",onClick:()=>et.windows.create({id:"debug",panel:"debug",size:{x:300,y:300},title:"Debug"})},{name:"Battle",icon:"B",onClick:()=>et.windows.create({id:"battle",panel:"battle",size:{x:595,y:417},title:"Battle"})},{name:"Fight",icon:"F",onClick:()=>{mt.get().player.healthCur.set(mt.get().player.healthMax.get())}}]]}class Bt extends G{constructor(t){super(),K(this,t,Pt,It,s,{})}}function Tt(t){let e,n,o,i,s,r,l,d,g,h,w,y=t[1].tags.armor.health+"",x=t[1].tags.armor.block+"";return{c(){e=f("div"),n=f("div"),o=m(),i=f("div"),s=p(y),r=m(),l=f("div"),d=f("div"),g=m(),h=f("div"),w=p(x),$(n,"class","stat-icon icon-itemstats icon-itemstats-health svelte-1rrz1qa"),$(i,"class","item-value svelte-1rrz1qa"),$(e,"class","item-row svelte-1rrz1qa"),$(d,"class","stat-icon icon-itemstats icon-itemstats-block svelte-1rrz1qa"),$(h,"class","item-value svelte-1rrz1qa"),$(l,"class","item-row svelte-1rrz1qa")},m(t,u){c(t,e,u),a(e,n),a(e,o),a(e,i),a(i,s),c(t,r,u),c(t,l,u),a(l,d),a(l,g),a(l,h),a(h,w)},p(t,e){2&e&&y!==(y=t[1].tags.armor.health+"")&&v(s,y),2&e&&x!==(x=t[1].tags.armor.block+"")&&v(w,x)},d(t){t&&u(e),t&&u(r),t&&u(l)}}}function jt(t){let e,n,o,i,s,r,l,d=`translateX(${100-t[1].tags.weapon.attackClock/t[1].tags.weapon.attackInterval*100}%)`,g=t[1].tags.weapon.attack+"";return{c(){e=f("div"),n=m(),o=f("div"),i=f("div"),s=m(),r=f("div"),l=p(g),$(e,"class","attack-progress svelte-1rrz1qa"),y(e,"transform",d,!1),$(i,"class","stat-icon icon-itemstats icon-itemstats-attack svelte-1rrz1qa"),$(r,"class","item-value svelte-1rrz1qa"),$(o,"class","item-row svelte-1rrz1qa")},m(t,u){c(t,e,u),c(t,n,u),c(t,o,u),a(o,i),a(o,s),a(o,r),a(r,l)},p(t,n){2&n&&d!==(d=`translateX(${100-t[1].tags.weapon.attackClock/t[1].tags.weapon.attackInterval*100}%)`)&&y(e,"transform",d,!1),2&n&&g!==(g=t[1].tags.weapon.attack+"")&&v(l,g)},d(t){t&&u(e),t&&u(n),t&&u(o)}}}function Dt(e){let n,o,i,s,r,l=e[1].type+"",d=`${ft.itemSize}px`,g=`${ft.itemSize}px`,h=e[1].tags.armor&&Tt(e),w=e[1].tags.weapon&&jt(e);return{c(){n=f("div"),o=f("div"),i=p(l),s=m(),h&&h.c(),r=m(),w&&w.c(),$(o,"class","name-type svelte-1rrz1qa"),$(n,"class","item svelte-1rrz1qa"),y(n,"width",d,!1),y(n,"height",g,!1)},m(t,e){c(t,n,e),a(n,o),a(o,i),a(n,s),h&&h.m(n,null),a(n,r),w&&w.m(n,null)},p(t,[e]){2&e&&l!==(l=t[1].type+"")&&v(i,l),t[1].tags.armor?h?h.p(t,e):(h=Tt(t),h.c(),h.m(n,r)):h&&(h.d(1),h=null),t[1].tags.weapon?w?w.p(t,e):(w=jt(t),w.c(),w.m(n,null)):w&&(w.d(1),w=null)},i:t,o:t,d(t){t&&u(n),h&&h.d(),w&&w.d()}}}function Yt(e,n,o){let i,s=t,l=()=>(s(),s=r(a,(t=>o(1,i=t))),a);e.$$.on_destroy.push((()=>s()));let{item:a}=n;return l(),e.$$set=t=>{"item"in t&&l(o(0,a=t.item))},[a,i]}class Lt extends G{constructor(t){super(),K(this,t,Yt,Dt,s,{item:0})}}function Xt(t,e,n){const o=t.slice();return o[14]=e[n],o}function Ft(e){let n,o=e[1].types,i=[];for(let t=0;t<o.length;t+=1)i[t]=Nt(Xt(e,o,t));return{c(){n=f("div");for(let t=0;t<i.length;t+=1)i[t].c();$(n,"class","name-type svelte-1vpmx2y")},m(t,e){c(t,n,e);for(let t=0;t<i.length;t+=1)i[t].m(n,null)},p(t,e){if(2&e){let s;for(o=t[1].types,s=0;s<o.length;s+=1){const r=Xt(t,o,s);i[s]?i[s].p(r,e):(i[s]=Nt(r),i[s].c(),i[s].m(n,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=o.length}},i:t,o:t,d(t){t&&u(n),d(i,t)}}}function Rt(t){let e,n;return e=new Lt({props:{item:t[3]}}),{c(){W(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};8&n&&(o.item=t[3]),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){R(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Nt(t){let e,n,o=t[14]+"";return{c(){e=f("div"),n=p(o),$(e,"class","slot-type")},m(t,o){c(t,e,o),a(e,n)},p(t,e){2&e&&o!==(o=t[14]+"")&&v(n,o)},d(t){t&&u(e)}}}function Wt(t){let e,n,i,s,r,l,a=`${ft.itemSize}px`,d=`${ft.itemSize}px`;const p=[Rt,Ft],m=[];function g(t,e){return null!=t[3]?0:1}return n=g(t),i=m[n]=p[n](t),{c(){e=f("div"),i.c(),$(e,"class","item-slot svelte-1vpmx2y"),y(e,"width",a,!1),y(e,"height",d,!1),y(e,"background-color",t[2],!1),y(e,"cursor",null==t[5].item?"":"pointer",!1)},m(o,i){c(o,e,i),m[n].m(e,null),s=!0,r||(l=[h(e,"mouseenter",t[8]),h(e,"mouseleave",t[9]),h(e,"click",t[7])],r=!0)},p(t,[o]){let s=n;n=g(t),n===s?m[n].p(t,o):(L(),R(m[s],1,1,(()=>{m[s]=null})),X(),i=m[n],i?i.p(t,o):(i=m[n]=p[n](t),i.c()),F(i,1),i.m(e,null)),4&o&&y(e,"background-color",t[2],!1),32&o&&y(e,"cursor",null==t[5].item?"":"pointer",!1)},i(t){s||(F(i),s=!0)},o(t){R(i),s=!1},d(t){t&&u(e),m[n].d(),r=!1,o(l)}}}function Ut(e,n,o){let i,s,a,c,u,d,f=t,p=t,m=()=>(p(),p=r(h,(t=>o(1,u=t))),h);e.$$.on_destroy.push((()=>f())),e.$$.on_destroy.push((()=>p()));let{id:g}=n,{slot:h}=n;m();let{slotIndex:$}=n;const{cursor:v}=mt.get().inventories;l(e,v,(t=>o(12,d=t)));let w="";return e.$$set=t=>{"id"in t&&o(10,g=t.id),"slot"in t&&m(o(0,h=t.slot)),"slotIndex"in t&&o(11,$=t.slotIndex)},e.$$.update=()=>{1024&e.$$.dirty&&(i=mt.get().inventories[g]),2&e.$$.dirty&&o(3,s=u.item),4096&e.$$.dirty&&(o(4,a=d[0]),f(),f=r(a,(t=>o(5,c=t))))},[h,u,w,s,a,c,v,function(t){if(t.stopPropagation(),null!=s){if(t.shiftKey)return void et.inventory.remove(i,$);et.inventory.transfer(s,i,v,0)}else{if(null==c.item)return;et.inventory.transfer(c.item,v,i,$)&&o(2,w="")}},function(t){null==c.item?o(2,w=""):u.types.length>0&&!u.types.includes(c.item.get().type)?o(2,w="#b53b3b"):o(2,w="#378e37")},function(t){o(2,w="")},g,$,d]}class Ht extends G{constructor(t){super(),K(this,t,Ut,Wt,s,{id:10,slot:0,slotIndex:11})}}function Jt(t,e,n){const o=t.slice();return o[5]=e[n],o[7]=n,o}function Kt(t){let e,n,o,i,s=`${ft.itemSize}px`,r=`${ft.itemSize}px`;return n=new Ht({props:{id:"backpack",slotIndex:t[7],slot:t[5]}}),{c(){e=f("div"),W(n.$$.fragment),o=m(),$(e,"class","slot-container svelte-qo3i7m"),y(e,"width",s,!1),y(e,"height",r,!1)},m(t,s){c(t,e,s),U(n,e,null),a(e,o),i=!0},p(t,e){const o={};2&e&&(o.slot=t[5]),n.$set(o)},i(t){i||(F(n.$$.fragment,t),i=!0)},o(t){R(n.$$.fragment,t),i=!1},d(t){t&&u(e),H(n)}}}function Gt(t){let e,n,o=t[1],i=[];for(let e=0;e<o.length;e+=1)i[e]=Kt(Jt(t,o,e));const s=t=>R(i[t],1,1,(()=>{i[t]=null}));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=g()},m(t,o){for(let e=0;e<i.length;e+=1)i[e].m(t,o);c(t,e,o),n=!0},p(t,[n]){if(2&n){let r;for(o=t[1],r=0;r<o.length;r+=1){const s=Jt(t,o,r);i[r]?(i[r].p(s,n),F(i[r],1)):(i[r]=Kt(s),i[r].c(),F(i[r],1),i[r].m(e.parentNode,e))}for(L(),r=o.length;r<i.length;r+=1)s(r);X()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)F(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)R(i[t]);n=!1},d(t){d(i,t),t&&u(e)}}}function Qt(e,n,o){let i,s,a=t,c=()=>(a(),a=r(u,(t=>o(3,i=t))),u);e.$$.on_destroy.push((()=>a()));let{window:u}=n;c();const{backpack:d}=mt.get().inventories;return l(e,d,(t=>o(1,s=t))),e.$$set=t=>{"window"in t&&c(o(0,u=t.window))},e.$$.update=()=>{e.$$.dirty},[u,s,d,i]}class Vt extends G{constructor(t){super(),K(this,t,Qt,Gt,s,{window:0})}}function Zt(e){let n,o,i,s,r,l,d,g,h,$,w,y,x,b,k;return{c(){n=f("div"),o=p("Elapsed total: "),i=p(e[1]),s=m(),r=f("div"),l=p("Elapsed in session: "),d=p(e[2]),g=m(),h=f("div"),$=p("Until next save: "),w=p(e[3]),y=m(),x=f("div"),b=p("Player distance: "),k=p(e[4])},m(t,e){c(t,n,e),a(n,o),a(n,i),c(t,s,e),c(t,r,e),a(r,l),a(r,d),c(t,g,e),c(t,h,e),a(h,$),a(h,w),c(t,y,e),c(t,x,e),a(x,b),a(x,k)},p(t,[e]){2&e&&v(i,t[1]),4&e&&v(d,t[2]),8&e&&v(w,t[3]),16&e&&v(k,t[4])},i:t,o:t,d(t){t&&u(n),t&&u(s),t&&u(r),t&&u(g),t&&u(h),t&&u(y),t&&u(x)}}}function te(e,n,o){let i,s,a,c,u,d=t,f=()=>(d(),d=r(p,(t=>o(9,i=t))),p);e.$$.on_destroy.push((()=>d()));let{window:p}=n;f();const{timeElapsedTotal:m,timeElapsedSession:g,timeToNextSave:h}=mt.get().stats;l(e,m,(t=>o(1,s=t))),l(e,g,(t=>o(2,a=t))),l(e,h,(t=>o(3,c=t)));const{y:$}=mt.get().player;return l(e,$,(t=>o(4,u=t))),e.$$set=t=>{"window"in t&&f(o(0,p=t.window))},e.$$.update=()=>{e.$$.dirty},[p,s,a,c,u,m,g,h,$,i]}class ee extends G{constructor(t){super(),K(this,t,te,Zt,s,{window:0})}}function ne(t,e,n){const o=t.slice();return o[12]=e[n],o[14]=n,o}function oe(t){let e,n,o,i,s=`${ft.itemSize}px`,r=`${ft.itemSize}px`,l=`${t[9][t[14]].x}px`,d=`${t[9][t[14]].y}px`;return n=new Ht({props:{id:"equipment",slotIndex:t[14],slot:t[12]}}),{c(){e=f("div"),W(n.$$.fragment),o=m(),$(e,"class","slot-container svelte-19crgj5"),y(e,"width",s,!1),y(e,"height",r,!1),y(e,"left",l,!1),y(e,"top",d,!1)},m(t,s){c(t,e,s),U(n,e,null),a(e,o),i=!0},p(t,e){const o={};16&e&&(o.slot=t[12]),n.$set(o)},i(t){i||(F(n.$$.fragment,t),i=!0)},o(t){R(n.$$.fragment,t),i=!1},d(t){t&&u(e),H(n)}}}function ie(t){let e,n,o,i,s,r,l,h,$,w,y,x,b=t[4],k=[];for(let e=0;e<b.length;e+=1)k[e]=oe(ne(t,b,e));const z=t=>R(k[t],1,1,(()=>{k[t]=null}));return{c(){e=f("div"),n=p("HP: "),o=p(t[1]),i=p("/"),s=p(t[2]),r=m(),l=f("div"),h=p("BLK: "),$=p(t[3]),w=m();for(let t=0;t<k.length;t+=1)k[t].c();y=g()},m(t,u){c(t,e,u),a(e,n),a(e,o),a(e,i),a(e,s),c(t,r,u),c(t,l,u),a(l,h),a(l,$),c(t,w,u);for(let e=0;e<k.length;e+=1)k[e].m(t,u);c(t,y,u),x=!0},p(t,[e]){if((!x||2&e)&&v(o,t[1]),(!x||4&e)&&v(s,t[2]),(!x||8&e)&&v($,t[3]),528&e){let n;for(b=t[4],n=0;n<b.length;n+=1){const o=ne(t,b,n);k[n]?(k[n].p(o,e),F(k[n],1)):(k[n]=oe(o),k[n].c(),F(k[n],1),k[n].m(y.parentNode,y))}for(L(),n=b.length;n<k.length;n+=1)z(n);X()}},i(t){if(!x){for(let t=0;t<b.length;t+=1)F(k[t]);x=!0}},o(t){k=k.filter(Boolean);for(let t=0;t<k.length;t+=1)R(k[t]);x=!1},d(t){t&&u(e),t&&u(r),t&&u(l),t&&u(w),d(k,t),t&&u(y)}}}function se(e,n,o){let i,s,a,c,u,d=t,f=()=>(d(),d=r(p,(t=>o(10,i=t))),p);e.$$.on_destroy.push((()=>d()));let{window:p}=n;f();const{equipment:m}=mt.get().inventories;l(e,m,(t=>o(4,u=t)));const{healthCur:g,healthMax:h,block:$}=mt.get().player;l(e,g,(t=>o(1,s=t))),l(e,h,(t=>o(2,a=t))),l(e,$,(t=>o(3,c=t)));return e.$$set=t=>{"window"in t&&f(o(0,p=t.window))},e.$$.update=()=>{e.$$.dirty},[p,s,a,c,u,m,g,h,$,[{x:0,y:66},{x:132,y:66},{x:66,y:0},{x:66,y:66},{x:66,y:132}],i]}class re extends G{constructor(t){super(),K(this,t,se,ie,s,{window:0})}}function le(e){let n,o,s,r;return{c(){n=f("div"),o=p(e[0]),$(n,"class","button svelte-o7hrlv")},m(t,l){c(t,n,l),a(n,o),s||(r=h(n,"click",(function(){i(e[1])&&e[1].apply(this,arguments)})),s=!0)},p(t,[n]){e=t,1&n&&v(o,e[0])},i:t,o:t,d(t){t&&u(n),s=!1,r()}}}function ae(t,e,n){let{name:o}=e,{onClick:i}=e;return t.$$set=t=>{"name"in t&&n(0,o=t.name),"onClick"in t&&n(1,i=t.onClick)},[o,i]}class ce extends G{constructor(t){super(),K(this,t,ae,le,s,{name:0,onClick:1})}}function ue(t,e,n){const o=t.slice();return o[1]=e[n],o}function de(t){let e,n,o=t[0],i=[];for(let e=0;e<o.length;e+=1)i[e]=fe(ue(t,o,e));const s=t=>R(i[t],1,1,(()=>{i[t]=null}));return{c(){e=f("div");for(let t=0;t<i.length;t+=1)i[t].c();$(e,"class","buttons svelte-xxps72")},m(t,o){c(t,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,n){if(1&n){let r;for(o=t[0],r=0;r<o.length;r+=1){const s=ue(t,o,r);i[r]?(i[r].p(s,n),F(i[r],1)):(i[r]=fe(s),i[r].c(),F(i[r],1),i[r].m(e,null))}for(L(),r=o.length;r<i.length;r+=1)s(r);X()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)F(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)R(i[t]);n=!1},d(t){t&&u(e),d(i,t)}}}function fe(t){let e,n;return e=new ce({props:{name:t[1].name,onClick:t[1].onClick}}),{c(){W(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.name=t[1].name),1&n&&(o.onClick=t[1].onClick),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){R(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function pe(t){let e,n,o=t[0].length>0&&de(t);return{c(){o&&o.c(),e=g()},m(t,i){o&&o.m(t,i),c(t,e,i),n=!0},p(t,[n]){t[0].length>0?o?(o.p(t,n),1&n&&F(o,1)):(o=de(t),o.c(),F(o,1),o.m(e.parentNode,e)):o&&(L(),R(o,1,1,(()=>{o=null})),X())},i(t){n||(F(o),n=!0)},o(t){R(o),n=!1},d(t){o&&o.d(t),t&&u(e)}}}function me(t,e,n){let{buttons:o}=e;return t.$$set=t=>{"buttons"in t&&n(0,o=t.buttons)},[o]}class ge extends G{constructor(t){super(),K(this,t,me,pe,s,{buttons:0})}}function he(e){let n,o,i,s,r,l,d;return l=new ge({props:{buttons:[{name:"Close",onClick:e[2]},{name:"Copy to Clipboard",onClick:e[3]}]}}),{c(){n=f("div"),o=f("div"),o.textContent="Save export:",i=m(),s=f("textarea"),r=m(),W(l.$$.fragment),s.readOnly=!0,s.value=e[1],$(s,"class","svelte-z2ujem"),$(n,"class","container svelte-z2ujem")},m(t,e){c(t,n,e),a(n,o),a(n,i),a(n,s),a(n,r),U(l,n,null),d=!0},p:t,i(t){d||(F(l.$$.fragment,t),d=!0)},o(t){R(l.$$.fragment,t),d=!1},d(t){t&&u(n),H(l)}}}function $e(e,n,o){let i,s=t,l=()=>(s(),s=r(a,(t=>o(4,i=t))),a);e.$$.on_destroy.push((()=>s()));let{window:a}=n;l();let c=(gt(),localStorage.getItem(dt));return e.$$set=t=>{"window"in t&&l(o(0,a=t.window))},e.$$.update=()=>{e.$$.dirty},[a,c,function(t){t.stopPropagation(),et.windows.remove(a)},function(t){t.stopPropagation(),null!=c?(navigator.clipboard.writeText(c),et.windows.create({panel:"information",title:"Done!",size:{x:300,y:"auto"},content:"Your save export has been placed in your clipboard."})):et.windows.create({panel:"information",title:"Error!",size:{x:300,y:"auto"},content:"An unknown problem occured when trying to export your save."})},i]}class ve extends G{constructor(t){super(),K(this,t,$e,he,s,{window:0})}}function we(t){let e,n,o,i,s,r,l,d,p;return r=new ge({props:{buttons:[{name:"Close",onClick:t[2]},{name:"Import Save",onClick:t[3]}]}}),{c(){e=f("div"),n=f("div"),n.textContent="Save import:",o=m(),i=f("textarea"),s=m(),W(r.$$.fragment),$(i,"class","svelte-z2ujem"),$(e,"class","container svelte-z2ujem")},m(u,f){c(u,e,f),a(e,n),a(e,o),a(e,i),w(i,t[1]),a(e,s),U(r,e,null),l=!0,d||(p=h(i,"input",t[5]),d=!0)},p(t,[e]){2&e&&w(i,t[1])},i(t){l||(F(r.$$.fragment,t),l=!0)},o(t){R(r.$$.fragment,t),l=!1},d(t){t&&u(e),H(r),d=!1,p()}}}function ye(e,n,o){let i,s=t,l=()=>(s(),s=r(a,(t=>o(4,i=t))),a);e.$$.on_destroy.push((()=>s()));let{window:a}=n;l();let c="";return e.$$set=t=>{"window"in t&&l(o(0,a=t.window))},e.$$.update=()=>{e.$$.dirty},[a,c,function(t){t.stopPropagation(),et.windows.remove(a)},function(t){t.stopPropagation(),ht(c,!0)?et.windows.create({panel:"information",title:"Save loaded",size:{x:300,y:"auto"},content:"Imported save loaded."}):et.windows.create({panel:"information",title:"Error",size:{x:300,y:"auto"},content:"Failed to import your save."})},i,function(){c=this.value,o(1,c)}]}class xe extends G{constructor(t){super(),K(this,t,ye,we,s,{window:0})}}function be(t){let e,n,o,i,s,r,l=t[1].content+"";return s=new ge({props:{buttons:[{name:"Close",onClick:t[2]}]}}),{c(){e=f("div"),n=f("div"),o=p(l),i=m(),W(s.$$.fragment),$(e,"class","container svelte-1dcwpe7")},m(t,l){c(t,e,l),a(e,n),a(n,o),a(e,i),U(s,e,null),r=!0},p(t,[e]){(!r||2&e)&&l!==(l=t[1].content+"")&&v(o,l)},i(t){r||(F(s.$$.fragment,t),r=!0)},o(t){R(s.$$.fragment,t),r=!1},d(t){t&&u(e),H(s)}}}function ke(e,n,o){let i,s,l=t,a=()=>(l(),l=r(c,(t=>o(3,s=t))),c);e.$$.on_destroy.push((()=>l()));let{window:c}=n;return a(),e.$$set=t=>{"window"in t&&a(o(0,c=t.window))},e.$$.update=()=>{8&e.$$.dirty&&o(1,i=s)},[c,i,function(t){t.stopPropagation(),et.windows.remove(c)},s]}class ze extends G{constructor(t){super(),K(this,t,ke,be,s,{window:0})}}function Ce(t){let e,n,o=t[1].damage+"";return{c(){e=f("div"),n=p(o),$(e,"class","enemy-damage svelte-1qheor4")},m(t,o){c(t,e,o),a(e,n)},p(t,e){2&e&&o!==(o=t[1].damage+"")&&v(n,o)},d(t){t&&u(e)}}}function Me(e){let n,o,i,s,r=`translateY(${100-e[1].healthCur/e[1].healthMax*100}%)`,l=!e[1].dead&&Ce(e);return{c(){n=f("div"),o=f("div"),i=f("div"),s=m(),l&&l.c(),$(i,"class","enemy-health svelte-1qheor4"),y(i,"transform",r,!1),$(o,"class","enemy-fill svelte-1qheor4"),$(n,"class","enemy svelte-1qheor4")},m(t,e){c(t,n,e),a(n,o),a(o,i),a(n,s),l&&l.m(n,null)},p(t,[e]){2&e&&r!==(r=`translateY(${100-t[1].healthCur/t[1].healthMax*100}%)`)&&y(i,"transform",r,!1),t[1].dead?l&&(l.d(1),l=null):l?l.p(t,e):(l=Ce(t),l.c(),l.m(n,null))},i:t,o:t,d(t){t&&u(n),l&&l.d()}}}function _e(e,n,o){let i,s=t,l=()=>(s(),s=r(a,(t=>o(1,i=t))),a);e.$$.on_destroy.push((()=>s()));let{enemy:a}=n;return l(),e.$$set=t=>{"enemy"in t&&l(o(0,a=t.enemy))},[a,i]}class Ae extends G{constructor(t){super(),K(this,t,_e,Me,s,{enemy:0})}}function Ee(t){let e,n;return e=new Ae({props:{enemy:t[1].enemy}}),{c(){W(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.enemy=t[1].enemy),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){R(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Oe(t){let e,n,o,i=null!=t[1].enemy&&Ee(t);return{c(){e=f("div"),n=f("div"),i&&i.c(),$(n,"class","grid-cell-adjust svelte-pvo1zz"),$(e,"class","grid-cell svelte-pvo1zz")},m(t,s){c(t,e,s),a(e,n),i&&i.m(n,null),o=!0},p(t,[e]){null!=t[1].enemy?i?(i.p(t,e),2&e&&F(i,1)):(i=Ee(t),i.c(),F(i,1),i.m(n,null)):i&&(L(),R(i,1,1,(()=>{i=null})),X())},i(t){o||(F(i),o=!0)},o(t){R(i),o=!1},d(t){t&&u(e),i&&i.d()}}}function Se(e,n,o){let i,s=t,l=()=>(s(),s=r(a,(t=>o(1,i=t))),a);e.$$.on_destroy.push((()=>s()));let{cell:a}=n;return l(),e.$$set=t=>{"cell"in t&&l(o(0,a=t.cell))},[a,i]}class qe extends G{constructor(t){super(),K(this,t,Se,Oe,s,{cell:0})}}function Ie(t,e,n){const o=t.slice();return o[2]=e[n],o}function Pe(t){let e,n;return e=new qe({props:{cell:t[2]}}),{c(){W(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.cell=t[2]),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){R(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Be(t){let e,n,o=`repeat(${t[1].length}, ${100/t[1].length}%)`,i=t[1],s=[];for(let e=0;e<i.length;e+=1)s[e]=Pe(Ie(t,i,e));const r=t=>R(s[t],1,1,(()=>{s[t]=null}));return{c(){e=f("div");for(let t=0;t<s.length;t+=1)s[t].c();$(e,"class","grid-row svelte-15yw0nb"),y(e,"grid-template-columns",o,!1)},m(t,o){c(t,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){if(2&n){let o;for(i=t[1],o=0;o<i.length;o+=1){const r=Ie(t,i,o);s[o]?(s[o].p(r,n),F(s[o],1)):(s[o]=Pe(r),s[o].c(),F(s[o],1),s[o].m(e,null))}for(L(),o=i.length;o<s.length;o+=1)r(o);X()}2&n&&o!==(o=`repeat(${t[1].length}, ${100/t[1].length}%)`)&&y(e,"grid-template-columns",o,!1)},i(t){if(!n){for(let t=0;t<i.length;t+=1)F(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)R(s[t]);n=!1},d(t){t&&u(e),d(s,t)}}}function Te(e,n,o){let i,s=t,l=()=>(s(),s=r(a,(t=>o(1,i=t))),a);e.$$.on_destroy.push((()=>s()));let{row:a}=n;return l(),e.$$set=t=>{"row"in t&&l(o(0,a=t.row))},[a,i]}class je extends G{constructor(t){super(),K(this,t,Te,Be,s,{row:0})}}function De(t,e,n){const o=t.slice();return o[7]=e[n],o}function Ye(t){let e,n;return e=new je({props:{row:t[7]}}),{c(){W(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.row=t[7]),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){R(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Le(t){let e,n,o,i=`${t[0]}px`,s=`flex: 0 0 ${t[0]}px`,r=`repeat(${t[2].length}, 64px)`,l=`${t[0]+64+64}px`,p=`translateY(${t[1]%1*64}px)`,m=t[2],g=[];for(let e=0;e<m.length;e+=1)g[e]=Ye(De(t,m,e));const h=t=>R(g[t],1,1,(()=>{g[t]=null}));return{c(){e=f("div"),n=f("div");for(let t=0;t<g.length;t+=1)g[t].c();$(n,"class","grid svelte-1llcezi"),y(n,"width",i,!1),y(n,"flex",s,!1),y(n,"grid-template-rows",r,!1),$(e,"class","grid-stretch svelte-1llcezi"),y(e,"top","-64px",!1),y(e,"height",l,!1),y(e,"transform",p,!1)},m(t,i){c(t,e,i),a(e,n);for(let t=0;t<g.length;t+=1)g[t].m(n,null);o=!0},p(t,[o]){if(4&o){let e;for(m=t[2],e=0;e<m.length;e+=1){const i=De(t,m,e);g[e]?(g[e].p(i,o),F(g[e],1)):(g[e]=Ye(i),g[e].c(),F(g[e],1),g[e].m(n,null))}for(L(),e=m.length;e<g.length;e+=1)h(e);X()}1&o&&i!==(i=`${t[0]}px`)&&y(n,"width",i,!1),1&o&&s!==(s=`flex: 0 0 ${t[0]}px`)&&y(n,"flex",s,!1),4&o&&r!==(r=`repeat(${t[2].length}, 64px)`)&&y(n,"grid-template-rows",r,!1),1&o&&l!==(l=`${t[0]+64+64}px`)&&y(e,"height",l,!1),2&o&&p!==(p=`translateY(${t[1]%1*64}px)`)&&y(e,"transform",p,!1)},i(t){if(!o){for(let t=0;t<m.length;t+=1)F(g[t]);o=!0}},o(t){g=g.filter(Boolean);for(let t=0;t<g.length;t+=1)R(g[t]);o=!1},d(t){t&&u(e),d(g,t)}}}function Xe(t,e,n){let o,i,{battleWidth:s}=e;const{battle:r,player:a}=mt.get(),{grid:c}=r;l(t,c,(t=>n(2,i=t)));const{y:u}=a;return l(t,u,(t=>n(1,o=t))),t.$$set=t=>{"battleWidth"in t&&n(0,s=t.battleWidth)},[s,o,i,c,u]}class Fe extends G{constructor(t){super(),K(this,t,Xe,Le,s,{battleWidth:0})}}function Re(e){let n,o,i,s,r,l,d,p=`${e[1]}px`,g=`${e[1]}px`,h=`0 0 ${e[1]}px`;return l=new Fe({props:{battleWidth:e[1]}}),{c(){n=f("div"),o=f("div"),i=m(),s=f("div"),r=f("div"),W(l.$$.fragment),$(o,"class","info-container svelte-10u4o"),$(r,"class","grid-container svelte-10u4o"),y(r,"width",p,!1),y(r,"height",g,!1),$(s,"class","grid-container-row svelte-10u4o"),y(s,"flex",h,!1),$(n,"class","container svelte-10u4o")},m(t,e){c(t,n,e),a(n,o),a(n,i),a(n,s),a(s,r),U(l,r,null),d=!0},p:t,i(t){d||(F(l.$$.fragment,t),d=!0)},o(t){R(l.$$.fragment,t),d=!1},d(t){t&&u(n),H(l)}}}function Ne(e,n,o){let i,s=t,l=()=>(s(),s=r(a,(t=>o(2,i=t))),a);e.$$.on_destroy.push((()=>s()));let{window:a}=n;l();return mt.get(),e.$$set=t=>{"window"in t&&l(o(0,a=t.window))},e.$$.update=()=>{e.$$.dirty},[a,384,i]}class We extends G{constructor(t){super(),K(this,t,Ne,Re,s,{window:0})}}function Ue(t){let e,n,o,i,s;var r=t[4][t[3].panel];function l(t){return{props:{window:t[2]}}}return r&&(o=new r(l(t))),{c(){e=f("div"),n=f("div"),o&&W(o.$$.fragment),$(n,"class","panel-content svelte-rsv3za"),I((()=>t[5].call(n))),$(e,"class","panel svelte-rsv3za")},m(r,l){c(r,e,l),a(e,n),o&&U(o,n,null),i=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=f("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const o=k();let i;return o?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=h(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{i=h(n.contentWindow,"resize",e)}),a(t,n),()=>{(o||i&&n.contentWindow)&&i(),u(n)}}(n,t[5].bind(n)),s=!0},p(t,[e]){const i={};if(4&e&&(i.window=t[2]),r!==(r=t[4][t[3].panel])){if(o){L();const t=o;R(t.$$.fragment,1,0,(()=>{H(t,1)})),X()}r?(o=new r(l(t)),W(o.$$.fragment),F(o.$$.fragment,1),U(o,n,null)):o=null}else r&&o.$set(i)},i(t){s||(o&&F(o.$$.fragment,t),s=!0)},o(t){o&&R(o.$$.fragment,t),s=!1},d(t){t&&u(e),o&&H(o),i()}}}function He(e,n,o){let i,s,l=t,a=()=>(l(),l=r(c,(t=>o(3,s=t))),c);e.$$.on_destroy.push((()=>l()));let{window:c}=n;a();const u={backpack:Vt,equipment:re,debug:ee,save_export:ve,save_import:xe,information:ze,battle:We};let d=0;return e.$$set=t=>{"window"in t&&a(o(0,c=t.window))},e.$$.update=()=>{1&e.$$.dirty&&o(2,i=c)},[c,d,i,s,u,function(){d=this.clientWidth,o(1,d)}]}class Je extends G{constructor(t){super(),K(this,t,He,Ue,s,{window:0})}}const{window:Ke}=N;function Ge(e){let n,i,s,r,l,a,d,p,g,v,w,y,x,b,k,z,C,M,_;return{c(){n=f("div"),i=m(),s=f("div"),r=m(),l=f("div"),a=m(),d=f("div"),p=m(),g=f("div"),v=m(),w=f("div"),y=m(),x=f("div"),b=m(),k=f("div"),z=m(),C=f("div"),$(n,"class","resize svelte-1mkd0gt"),$(s,"class","border n svelte-1mkd0gt"),$(l,"class","border s svelte-1mkd0gt"),$(d,"class","border w svelte-1mkd0gt"),$(g,"class","border e svelte-1mkd0gt"),$(w,"class","border ne svelte-1mkd0gt"),$(x,"class","border nw svelte-1mkd0gt"),$(k,"class","border se svelte-1mkd0gt"),$(C,"class","border sw svelte-1mkd0gt")},m(t,o){c(t,n,o),c(t,i,o),c(t,s,o),c(t,r,o),c(t,l,o),c(t,a,o),c(t,d,o),c(t,p,o),c(t,g,o),c(t,v,o),c(t,w,o),c(t,y,o),c(t,x,o),c(t,b,o),c(t,k,o),c(t,z,o),c(t,C,o),M||(_=[h(s,"mousedown",e[20]),h(l,"mousedown",e[21]),h(d,"mousedown",e[22]),h(g,"mousedown",e[23]),h(w,"mousedown",e[24]),h(x,"mousedown",e[25]),h(k,"mousedown",e[26]),h(C,"mousedown",e[27])],M=!0)},p:t,d(t){t&&u(n),t&&u(i),t&&u(s),t&&u(r),t&&u(l),t&&u(a),t&&u(d),t&&u(p),t&&u(g),t&&u(v),t&&u(w),t&&u(y),t&&u(x),t&&u(b),t&&u(k),t&&u(z),t&&u(C),M=!1,o(_)}}}function Qe(t){let e,n,i,s,r,l,d,g,w,x,b,k,C,M,_,A=t[4].title+"";I(t[19]);let E=t[4].resizable&&Ge(t);return k=new Je({props:{window:t[0]}}),{c(){e=f("div"),E&&E.c(),n=m(),i=f("div"),s=f("div"),r=p(A),l=m(),d=f("div"),g=f("div"),g.innerHTML='<div class="small-inner small-col-gray minimize svelte-1mkd0gt"></div>',w=m(),x=f("div"),x.innerHTML='<div class="small-inner small-col-red close svelte-1mkd0gt"></div>',b=m(),W(k.$$.fragment),$(s,"class","title svelte-1mkd0gt"),$(g,"class","small svelte-1mkd0gt"),$(x,"class","small svelte-1mkd0gt"),$(d,"class","side svelte-1mkd0gt"),$(i,"class","top svelte-1mkd0gt"),y(i,"flex","0 0 "+Ve+"px"),z(i,"focused",t[9]),z(i,"unfocused",t[8]),$(e,"class","window svelte-1mkd0gt"),z(e,"focused",t[9]),z(e,"unfocused",t[8]),y(e,"display",t[4].minimized?"none":"initial",!1),y(e,"z-index",t[7],!1),y(e,"transform",`translate(${t[4].pos.x}px, ${t[4].pos.y}px)`,!1),y(e,"position","fixed",!1),y(e,"width",t[6],!1),y(e,"height",t[5],!1)},m(o,u){c(o,e,u),E&&E.m(e,null),a(e,n),a(e,i),a(i,s),a(s,r),a(i,l),a(i,d),a(d,g),a(d,w),a(d,x),a(e,b),U(k,e,null),t[28](e),C=!0,M||(_=[h(Ke,"resize",t[19]),h(g,"click",t[13]),h(g,"mousedown",Ze),h(x,"click",t[12]),h(x,"mousedown",Ze),h(i,"mousedown",t[10]),h(e,"click",tn),h(e,"mousedown",t[11])],M=!0)},p(t,o){t[4].resizable?E?E.p(t,o):(E=Ge(t),E.c(),E.m(e,n)):E&&(E.d(1),E=null),(!C||16&o[0])&&A!==(A=t[4].title+"")&&v(r,A),(!C||512&o[0])&&z(i,"focused",t[9]),(!C||256&o[0])&&z(i,"unfocused",t[8]);const s={};1&o[0]&&(s.window=t[0]),k.$set(s),(!C||512&o[0])&&z(e,"focused",t[9]),(!C||256&o[0])&&z(e,"unfocused",t[8]),16&o[0]&&y(e,"display",t[4].minimized?"none":"initial",!1),128&o[0]&&y(e,"z-index",t[7],!1),16&o[0]&&y(e,"transform",`translate(${t[4].pos.x}px, ${t[4].pos.y}px)`,!1),64&o[0]&&y(e,"width",t[6],!1),32&o[0]&&y(e,"height",t[5],!1)},i(t){C||(F(k.$$.fragment,t),C=!0)},o(t){R(k.$$.fragment,t),C=!1},d(n){n&&u(e),E&&E.d(),H(k),t[28](null),M=!1,o(_)}}}const Ve=26;function Ze(t){t.stopPropagation()}function tn(t){t.stopPropagation()}function en(e,n,o){let i,s,l,a,c,u,d=t,f=()=>(d(),d=r(m,(t=>o(4,u=t))),m);e.$$.on_destroy.push((()=>d()));let p,{window:m}=n;f(),mt.get();let g=0,h=0,$=0,v=0,w=null,y=null;function x(t){t.stopPropagation(),t.preventDefault(),w&&(et.windows.move(m,k(t.pageX-w.initialOffset.x,t.pageY-w.initialOffset.y)),o(17,w=null))}function b(t){if(t.stopPropagation(),t.preventDefault(),!w||!p)return;const e=k(t.pageX-w.initialOffset.x,t.pageY-w.initialOffset.y);o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p)}function k(t,e){let n=p.getBoundingClientRect(),o=Math.max(-n.width/2,t);o=Math.min(o,g-n.width/2);let i=Math.max(0,e);return i=Math.min(i,h-50),{x:o,y:i}}function z(t,e){if(0!==t.button)return;const n=p.getBoundingClientRect();o(18,y={from:e,initialRect:n,initialOffset:{x:t.pageX-n.left,y:t.pageY-n.top},initialMousePos:{x:t.pageX,y:t.pageY}}),t.preventDefault()}function C(t){if(t.stopPropagation(),t.preventDefault(),y&&p&&"number"==typeof u.size.x&&"number"==typeof u.size.y)if("nw"===y.from){const e=k(t.pageX-y.initialOffset.x,t.pageY-y.initialOffset.y),n=t.pageX-y.initialRect.x-y.initialOffset.x,i=t.pageY-y.initialRect.y-y.initialOffset.y;o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p),o(1,p.style.width=u.size.x-n+"px",p),o(1,p.style.height=u.size.y-i+"px",p)}else{if(y.from.includes("w")){const e=k(t.pageX-y.initialOffset.x,y.initialMousePos.y-y.initialOffset.y),n=t.pageX-y.initialRect.x-y.initialOffset.x;o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p),o(1,p.style.width=u.size.x-n+"px",p)}if(y.from.includes("e")){const e=t.pageX-y.initialMousePos.x;o(1,p.style.width=`${u.size.x+e}px`,p)}if(y.from.includes("n")){const e=k(y.initialMousePos.x-y.initialOffset.x,t.pageY-y.initialOffset.y),n=t.pageY-y.initialRect.y-y.initialOffset.y;o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p),o(1,p.style.height=u.size.y-n+"px",p)}if(y.from.includes("s")){const e=t.pageY-y.initialMousePos.y;o(1,p.style.height=`${u.size.y+e}px`,p)}}}function _(t){if(t.stopPropagation(),t.preventDefault(),y&&"number"==typeof u.size.x&&"number"==typeof u.size.y){if("nw"===y.from){const e=t.pageX-y.initialRect.x-y.initialOffset.x,n=t.pageY-y.initialRect.y-y.initialOffset.y;et.windows.resize(m,{x:u.size.x-e,y:u.size.y-n}),et.windows.move(m,k(t.pageX-y.initialOffset.x,t.pageY-y.initialOffset.y))}else{if(y.from.includes("w")){const e=t.pageX-y.initialRect.x-y.initialOffset.x;et.windows.resize(m,{x:u.size.x-e,y:u.size.y}),et.windows.move(m,k(t.pageX-y.initialOffset.x,y.initialMousePos.y-y.initialOffset.y))}if(y.from.includes("e")){const e=t.pageX-y.initialMousePos.x;et.windows.resize(m,{x:u.size.x+e,y:u.size.y})}if(y.from.includes("n")){const e=t.pageY-y.initialRect.y-y.initialOffset.y;et.windows.resize(m,{x:u.size.x,y:u.size.y-e}),et.windows.move(m,k(y.initialMousePos.x-y.initialOffset.x,t.pageY-y.initialOffset.y))}if(y.from.includes("s")){const e=t.pageY-y.initialMousePos.y;et.windows.resize(m,{x:u.size.x,y:u.size.y+e})}}o(18,y=null)}}M((()=>{}));return e.$$set=t=>{"window"in t&&f(o(0,m=t.window))},e.$$.update=()=>{if(16&e.$$.dirty[0]&&o(9,i=u.selected),16&e.$$.dirty[0]&&o(8,s=!u.selected),16&e.$$.dirty[0]&&o(7,l=u.selected?2:1),16&e.$$.dirty[0]&&o(6,a="auto"===u.size.x?u.size.x:u.size.x+"px"),16&e.$$.dirty[0]&&o(5,c="auto"===u.size.y?u.size.y:u.size.y+"px"),131072&e.$$.dirty[0]&&(w?(document.addEventListener("mousemove",b),document.addEventListener("mouseup",x)):(document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",x))),262144&e.$$.dirty[0]&&(y?(document.addEventListener("mousemove",C),document.addEventListener("mouseup",_)):(document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",_))),98335&e.$$.dirty[0]&&(g!=$||h!=v)){let t=p.getBoundingClientRect();const e=k(t.left,t.top);e.x==u.pos.x&&e.y==u.pos.y||(et.windows.move(m,k(t.left,t.top)),o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p)),o(15,$=g),o(16,v=h)}},[m,p,g,h,u,c,a,l,s,i,function(t){if(0!==t.button)return;let e=p.getBoundingClientRect();o(17,w={initialOffset:{x:t.pageX-e.left,y:t.pageY-e.top}}),t.preventDefault()},function(t){0===t.button&&et.windows.select(m,!0)},function(t){0===t.button&&(et.windows.remove(m),t.preventDefault(),t.stopPropagation())},function(t){0===t.button&&(et.windows.select(m,!1),et.windows.minimize(m,!0),t.preventDefault(),t.stopPropagation())},z,$,v,w,y,function(){o(2,g=Ke.innerWidth),o(3,h=Ke.innerHeight)},t=>z(t,"n"),t=>z(t,"s"),t=>z(t,"w"),t=>z(t,"e"),t=>z(t,"ne"),t=>z(t,"nw"),t=>z(t,"se"),t=>z(t,"sw"),function(t){A[t?"unshift":"push"]((()=>{p=t,o(1,p),o(2,g),o(15,$),o(3,h),o(16,v),o(4,u),o(0,m)}))}]}class nn extends G{constructor(t){super(),K(this,t,en,Qe,s,{window:0},null,[-1,-1])}}function on(t,e,n){const o=t.slice();return o[2]=e[n],o}function sn(t){let e,n;return e=new nn({props:{window:t[2]}}),{c(){W(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.window=t[2]),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){R(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function rn(t){let e,n,o=t[0],i=[];for(let e=0;e<o.length;e+=1)i[e]=sn(on(t,o,e));const s=t=>R(i[t],1,1,(()=>{i[t]=null}));return{c(){e=f("div");for(let t=0;t<i.length;t+=1)i[t].c();$(e,"class","windows svelte-erncmc")},m(t,o){c(t,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,[n]){if(1&n){let r;for(o=t[0],r=0;r<o.length;r+=1){const s=on(t,o,r);i[r]?(i[r].p(s,n),F(i[r],1)):(i[r]=sn(s),i[r].c(),F(i[r],1),i[r].m(e,null))}for(L(),r=o.length;r<i.length;r+=1)s(r);X()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)F(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)R(i[t]);n=!1},d(t){t&&u(e),d(i,t)}}}function ln(t,e,n){let o;const{windows:i}=mt.get();return l(t,i,(t=>n(0,o=t))),[o,i]}class an extends G{constructor(t){super(),K(this,t,ln,rn,s,{})}}function cn(t){let e,n;return e=new Lt({props:{item:t[3].item}}),{c(){W(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};8&n&&(o.item=t[3].item),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){R(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function un(t){let e,n,o=`${t[0]+12}px`,i=`${t[1]+16}px`,s=null!=t[3].item&&cn(t);return{c(){e=f("div"),s&&s.c(),$(e,"class","cursor-slot svelte-y592g2"),y(e,"left",o,!1),y(e,"top",i,!1)},m(t,o){c(t,e,o),s&&s.m(e,null),n=!0},p(t,[n]){null!=t[3].item?s?(s.p(t,n),8&n&&F(s,1)):(s=cn(t),s.c(),F(s,1),s.m(e,null)):s&&(L(),R(s,1,1,(()=>{s=null})),X()),1&n&&o!==(o=`${t[0]+12}px`)&&y(e,"left",o,!1),2&n&&i!==(i=`${t[1]+16}px`)&&y(e,"top",i,!1)},i(t){n||(F(s),n=!0)},o(t){R(s),n=!1},d(t){t&&u(e),s&&s.d()}}}function dn(e,n,o){let i,s,a,c=t;e.$$.on_destroy.push((()=>c()));const{cursor:u}=mt.get().inventories;l(e,u,(t=>o(5,s=t)));let d=0,f=0;return document.addEventListener("mousemove",(t=>{o(0,d=t.pageX),o(1,f=t.pageY)})),e.$$.update=()=>{32&e.$$.dirty&&(o(2,i=s[0]),c(),c=r(i,(t=>o(3,a=t))))},[d,f,i,a,u,s]}class fn extends G{constructor(t){super(),K(this,t,dn,un,s,{})}}function pn(e){let n,o,i,s,r,l;return{c(){n=f("div"),o=f("div"),i=f("div"),s=p(e[2]),$(i,"class","text svelte-129069q"),$(o,"class","inner svelte-129069q"),z(o,"selected",e[1]),$(n,"class","item svelte-129069q")},m(t,u){c(t,n,u),a(n,o),a(o,i),a(i,s),r||(l=h(o,"click",e[3]),r=!0)},p(t,[e]){4&e&&v(s,t[2]),2&e&&z(o,"selected",t[1])},i:t,o:t,d(t){t&&u(n),r=!1,l()}}}function mn(e,n,o){let i,s,l,a=t,c=()=>(a(),a=r(u,(t=>o(4,l=t))),u);e.$$.on_destroy.push((()=>a())),mt.get();let{window:u}=n;return c(),e.$$set=t=>{"window"in t&&c(o(0,u=t.window))},e.$$.update=()=>{16&e.$$.dirty&&o(2,i=l.title),16&e.$$.dirty&&o(1,s=l.selected)},[u,s,i,function(t){s?(et.windows.minimize(u,!0),et.windows.select(u,!1)):(et.windows.minimize(u,!1),et.windows.select(u,!0)),t.stopPropagation()},l]}class gn extends G{constructor(t){super(),K(this,t,mn,pn,s,{window:0})}}function hn(e){let n,i,s,r,l,d,p,g,v,w,y,x,b,k;return{c(){n=f("div"),i=f("div"),s=f("div"),s.textContent="Close all windows",r=m(),l=f("div"),d=f("div"),d.textContent="Save",p=m(),g=f("div"),v=f("div"),v.textContent="Export",w=m(),y=f("div"),x=f("div"),x.textContent="Import",$(s,"class","menu-item-inner svelte-431mug"),$(i,"class","menu-item svelte-431mug"),$(d,"class","menu-item-inner svelte-431mug"),$(l,"class","menu-item svelte-431mug"),$(v,"class","menu-item-inner svelte-431mug"),$(g,"class","menu-item svelte-431mug"),$(x,"class","menu-item-inner svelte-431mug"),$(y,"class","menu-item svelte-431mug"),$(n,"class","menu svelte-431mug")},m(t,o){c(t,n,o),a(n,i),a(i,s),a(n,r),a(n,l),a(l,d),a(n,p),a(n,g),a(g,v),a(n,w),a(n,y),a(y,x),e[7](n),b||(k=[h(s,"click",e[3]),h(d,"click",e[4]),h(v,"click",e[5]),h(x,"click",e[6])],b=!0)},p:t,d(t){t&&u(n),e[7](null),b=!1,o(k)}}}function $n(e){let n,o,i,s,r,l,d=e[0]&&hn(e);return{c(){n=f("div"),o=f("div"),i=f("div"),i.textContent="Options",s=m(),d&&d.c(),$(i,"class","mainbtn-inner svelte-431mug"),$(o,"class","mainbtn svelte-431mug"),$(n,"class","left svelte-431mug")},m(t,u){c(t,n,u),a(n,o),a(o,i),a(n,s),d&&d.m(n,null),r||(l=h(i,"click",e[2]),r=!0)},p(t,[e]){t[0]?d?d.p(t,e):(d=hn(t),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},i:t,o:t,d(t){t&&u(n),d&&d.d(),r=!1,l()}}}function vn(t,e,n){mt.get();let o,i=!1;return document.addEventListener("click",(function(){i&&n(0,i=!1),et.windows.deselectAll()})),[i,o,function(t){n(0,i=!i),t.stopPropagation()},function(t){et.windows.removeAll()},function(t){gt()},function(t){et.windows.create({id:"save_export",panel:"save_export",size:{x:400,y:400},title:"Save Export"})},function(t){et.windows.create({id:"save_import",panel:"save_import",size:{x:400,y:400},title:"Save Import"})},function(t){A[t?"unshift":"push"]((()=>{o=t,n(1,o)}))}]}class wn extends G{constructor(t){super(),K(this,t,vn,$n,s,{})}}function yn(t,e,n){const o=t.slice();return o[2]=e[n],o}function xn(t){let e,n;return e=new gn({props:{window:t[2]}}),{c(){W(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.window=t[2]),e.$set(o)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){R(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function bn(t){let e,n,o,i,s;n=new wn({});let r=t[0],l=[];for(let e=0;e<r.length;e+=1)l[e]=xn(yn(t,r,e));const p=t=>R(l[t],1,1,(()=>{l[t]=null}));return{c(){e=f("div"),W(n.$$.fragment),o=m(),i=f("div");for(let t=0;t<l.length;t+=1)l[t].c();$(i,"class","middle svelte-1bpzds1"),$(e,"class","taskbar svelte-1bpzds1")},m(t,r){c(t,e,r),U(n,e,null),a(e,o),a(e,i);for(let t=0;t<l.length;t+=1)l[t].m(i,null);s=!0},p(t,[e]){if(1&e){let n;for(r=t[0],n=0;n<r.length;n+=1){const o=yn(t,r,n);l[n]?(l[n].p(o,e),F(l[n],1)):(l[n]=xn(o),l[n].c(),F(l[n],1),l[n].m(i,null))}for(L(),n=r.length;n<l.length;n+=1)p(n);X()}},i(t){if(!s){F(n.$$.fragment,t);for(let t=0;t<r.length;t+=1)F(l[t]);s=!0}},o(t){R(n.$$.fragment,t),l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)R(l[t]);s=!1},d(t){t&&u(e),H(n),d(l,t)}}}function kn(t,e,n){let o;const{windows:i}=mt.get();return l(t,i,(t=>n(0,o=t))),[o,i]}class zn extends G{constructor(t){super(),K(this,t,kn,bn,s,{})}}function Cn(e){let n,o,i,s,r,l,d,p,g,h,v;return n=new _t({}),s=new Bt({}),l=new zn({}),p=new an({}),h=new fn({}),{c(){W(n.$$.fragment),o=m(),i=f("div"),W(s.$$.fragment),r=m(),W(l.$$.fragment),d=m(),W(p.$$.fragment),g=m(),W(h.$$.fragment),$(i,"class","desktop svelte-r0tb1q")},m(t,e){U(n,t,e),c(t,o,e),c(t,i,e),U(s,i,null),a(i,r),U(l,i,null),c(t,d,e),U(p,t,e),c(t,g,e),U(h,t,e),v=!0},p:t,i(t){v||(F(n.$$.fragment,t),F(s.$$.fragment,t),F(l.$$.fragment,t),F(p.$$.fragment,t),F(h.$$.fragment,t),v=!0)},o(t){R(n.$$.fragment,t),R(s.$$.fragment,t),R(l.$$.fragment,t),R(p.$$.fragment,t),R(h.$$.fragment,t),v=!1},d(t){H(n,t),t&&u(o),t&&u(i),H(s),H(l),t&&u(d),H(p,t),t&&u(g),H(h,t)}}}function Mn(e){let n,o,i=e[0],r=Cn();return{c(){n=f("div"),r.c(),$(n,"class","app svelte-r0tb1q")},m(t,e){c(t,n,e),r.m(n,null),o=!0},p(e,[o]){1&o&&s(i,i=e[0])?(L(),R(r,1,1,t),X(),r=Cn(),r.c(),F(r,1),r.m(n,null)):r.p(e,o)},i(t){o||(F(r),o=!0)},o(t){R(r),o=!1},d(t){t&&u(n),r.d(t)}}}function _n(t,e,n){let o;l(t,mt,(t=>n(1,o=t)));let i={};return t.$$.update=()=>{2&t.$$.dirty&&(n(0,i={}),console.info("App reloaded."))},[i,o]}var An=new class extends G{constructor(t){super(),K(this,t,_n,Mn,s,{})}}({target:document.body});return window.onunhandledrejection=t=>{console.error(t)},console.info("Starting game."),ht(),requestAnimationFrame(at),An}();
//# sourceMappingURL=bundle.js.map
