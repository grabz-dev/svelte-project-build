var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function r(t,e,n){t.$$.on_destroy.push(l(e,n))}function a(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function g(){return p(" ")}function m(){return p("")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}function y(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}let x,k;function b(){if(void 0===x){x=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){x=!0}}return x}function z(t,e,n){t.classList[n?"add":"remove"](e)}function C(t){k=t}function M(){if(!k)throw new Error("Function called outside component initialization");return k}function S(t){M().$$.on_mount.push(t)}function I(t){M().$$.on_destroy.push(t)}const _=[],T=[],O=[],E=[],B=Promise.resolve();let q=!1;function A(t){O.push(t)}const P=new Set;let D=0;function N(){const t=k;do{for(;D<_.length;){const t=_[D];D++,C(t),j(t.$$)}for(C(null),_.length=0,D=0;T.length;)T.pop()();for(let t=0;t<O.length;t+=1){const e=O[t];P.has(e)||(P.add(e),e())}O.length=0}while(_.length);for(;E.length;)E.pop()();q=!1,P.clear(),C(t)}function j(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const X=new Set;let L;function Q(){L={r:0,c:[],p:L}}function U(){L.r||o(L.c),L=L.p}function R(t,e){t&&t.i&&(X.delete(t),t.i(e))}function Y(t,e,n,o){if(t&&t.o){if(X.has(t))return;X.add(t),L.c.push((()=>{X.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}const F="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function W(t){t&&t.c()}function H(t,n,i,l){const{fragment:r,on_mount:a,on_destroy:c,after_update:u}=t.$$;r&&r.m(n,i),l||A((()=>{const n=a.map(e).filter(s);c?c.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(A)}function G(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function J(t,e){-1===t.$$.dirty[0]&&(_.push(t),q||(q=!0,B.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(e,s,i,l,r,a,c,d=[-1]){const f=k;C(e);const p=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(f?f.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:s.target||f.$$.root};c&&c(p.root);let g=!1;if(p.ctx=i?i(e,s.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&r(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),g&&J(e,t)),n})):[],p.update(),g=!0,o(p.before_update),p.fragment=!!l&&l(p.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();s.intro&&R(e.$$.fragment),H(e,s.target,s.anchor,s.customElement),N()}C(f)}class V{$destroy(){G(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Z=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={},s=function(){return new Map};if("undefined"==typeof Map){var i=function(){this.data={}};i.prototype.get=function(t){return this.data.hasOwnProperty(t)?this.data[t]:null},i.prototype.set=function(t,e){this.data[t]=e},i.prototype.has=function(t){return this.data.hasOwnProperty(t)},i.prototype.delete=function(t){delete this.data[t]},s=function(){return new i}}function l(t,e){if(!o[t]){o[t]={};for(var n=0;n<t.length;n++)o[t][t[n]]=n}return o[t][e]}var r={compressToBase64:function(t){if(null==t)return"";var n=r._compress(t,6,(function(t){return e.charAt(t)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:r._decompress(t.length,32,(function(n){return l(e,t.charAt(n))}))},compressToUTF16:function(e){return null==e?"":r._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:r._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=r.compress(t),n=new Uint8Array(2*e.length),o=0,s=e.length;o<s;o++){var i=e.charCodeAt(o);n[2*o]=i>>>8,n[2*o+1]=i%256}return n},decompressFromUint8Array:function(e){if(null==e)return r.decompress(e);for(var n=new Array(e.length/2),o=0,s=n.length;o<s;o++)n[o]=256*e[2*o]+e[2*o+1];var i=[];return n.forEach((function(e){i.push(t(e))})),r.decompress(i.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":r._compress(t,6,(function(t){return n.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),r._decompress(t.length,32,(function(e){return l(n,t.charAt(e))})))},compress:function(e){return r._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,n){if(null==t)return"";var o,i,l,r=s(),a=s(),c="",u="",d="",f=2,p=3,g=2,m=[],h=0,v=0;for(l=0;l<t.length;l+=1)if(c=t[l],r.has(c)||(r.set(c,p++),a.set(c,!0)),u=d+c,r.has(u))d=u;else{if(a.has(d)){if(d.charCodeAt(0)<256){for(o=0;o<g;o++)h<<=1,v==e-1?(v=0,m.push(n(h)),h=0):v++;for(i=d.charCodeAt(0),o=0;o<8;o++)h=h<<1|1&i,v==e-1?(v=0,m.push(n(h)),h=0):v++,i>>=1}else{for(i=1,o=0;o<g;o++)h=h<<1|i,v==e-1?(v=0,m.push(n(h)),h=0):v++,i=0;for(i=d.charCodeAt(0),o=0;o<16;o++)h=h<<1|1&i,v==e-1?(v=0,m.push(n(h)),h=0):v++,i>>=1}0==--f&&(f=Math.pow(2,g),g++),a.delete(d)}else for(i=r.get(d),o=0;o<g;o++)h=h<<1|1&i,v==e-1?(v=0,m.push(n(h)),h=0):v++,i>>=1;0==--f&&(f=Math.pow(2,g),g++),r.set(u,p++),d=String(c)}if(""!==d){if(a.has(d)){if(d.charCodeAt(0)<256){for(o=0;o<g;o++)h<<=1,v==e-1?(v=0,m.push(n(h)),h=0):v++;for(i=d.charCodeAt(0),o=0;o<8;o++)h=h<<1|1&i,v==e-1?(v=0,m.push(n(h)),h=0):v++,i>>=1}else{for(i=1,o=0;o<g;o++)h=h<<1|i,v==e-1?(v=0,m.push(n(h)),h=0):v++,i=0;for(i=d.charCodeAt(0),o=0;o<16;o++)h=h<<1|1&i,v==e-1?(v=0,m.push(n(h)),h=0):v++,i>>=1}0==--f&&(f=Math.pow(2,g),g++),a.delete(d)}else for(i=r.get(d),o=0;o<g;o++)h=h<<1|1&i,v==e-1?(v=0,m.push(n(h)),h=0):v++,i>>=1;0==--f&&(f=Math.pow(2,g),g++)}for(i=2,o=0;o<g;o++)h=h<<1|1&i,v==e-1?(v=0,m.push(n(h)),h=0):v++,i>>=1;for(;;){if(h<<=1,v==e-1){m.push(n(h));break}v++}return m.join("")},decompress:function(t){return null==t?"":""==t?null:r._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,n,o){var i,l,r,a,c,u,d,f=s(),p=4,g=4,m=3,h="",v=[],$={val:o(0),position:n,index:1};for(i=0;i<3;i+=1)f.set(i,i);for(r=0,c=Math.pow(2,2),u=1;u!=c;)a=$.val&$.position,$.position>>=1,0==$.position&&($.position=n,$.val=o($.index++)),r|=(a>0?1:0)*u,u<<=1;switch(r){case 0:for(r=0,c=Math.pow(2,8),u=1;u!=c;)a=$.val&$.position,$.position>>=1,0==$.position&&($.position=n,$.val=o($.index++)),r|=(a>0?1:0)*u,u<<=1;d=t(r);break;case 1:for(r=0,c=Math.pow(2,16),u=1;u!=c;)a=$.val&$.position,$.position>>=1,0==$.position&&($.position=n,$.val=o($.index++)),r|=(a>0?1:0)*u,u<<=1;d=t(r);break;case 2:return""}for(f.set(3,d),l=d,v.push(d);;){if($.index>e)return"";for(r=0,c=Math.pow(2,m),u=1;u!=c;)a=$.val&$.position,$.position>>=1,0==$.position&&($.position=n,$.val=o($.index++)),r|=(a>0?1:0)*u,u<<=1;switch(d=r){case 0:for(r=0,c=Math.pow(2,8),u=1;u!=c;)a=$.val&$.position,$.position>>=1,0==$.position&&($.position=n,$.val=o($.index++)),r|=(a>0?1:0)*u,u<<=1;f.set(g++,t(r)),d=g-1,p--;break;case 1:for(r=0,c=Math.pow(2,16),u=1;u!=c;)a=$.val&$.position,$.position>>=1,0==$.position&&($.position=n,$.val=o($.index++)),r|=(a>0?1:0)*u,u<<=1;f.set(g++,t(r)),d=g-1,p--;break;case 2:return v.join("")}if(0==p&&(p=Math.pow(2,m),m++),f.get(d))h=f.get(d);else{if(d!==g)return null;h=l+l[0]}v.push(h),f.set(g++,l+h[0]),l=h,0==--p&&(p=Math.pow(2,m),m++)}}};return r}();function tt(t){let e=t;const n=[],o=t=>{e=t,n.forEach((t=>t(e)))};return{subscribe:t=>(n.push(t),t(e),()=>{const e=n.findIndex((e=>e===t));n.splice(e,1)}),set:o,update:t=>o(t(e)),get:()=>e}}"function"==typeof define&&define.amd?define((function(){return Z})):"undefined"!=typeof module&&null!=module&&(module.exports=Z);const et=["","K","M","B","T","Qa","Qi","Sx","Sp","Oc","No","Dc","Ud","Dd","Td","Qad","Qid","Sxd","Spd","Od","Nd","V","Uv","Dv","Tv","Qav","Qiv","Sxv","Spv","Ov","Nv","Tg","Utg","Dtg","Ttg","Qatg","Qitg","Sxtg","Sptg","Otg","Ntg","Qaa","Uqa","Dqa","Tqa","Qaqa","Qiqa","Sxqa","Spqa","Oqa","Nqa","Qia","Uqi","Dqi","Tqi","Qaqi","Qiqi","Sxqi","Spqi","Oqi","Nqi","Sxa","Usx","Dsx","Tsx","Qasx","Qisx","Sxsx","Spsx","Osx","Nsx","Spa","Usp","Dsp","Tsp","Qasp","Qisp","Sxsp","Spsp","Osp","Nsp","Og","Uog","Dog","Tog","Qaog","Qiog","Sxog","Spog","Oog","Nog","Na","Un","Dn","Tn","Qan","Qin","Sxn","Spn","On","Nn","Ct","Uc"];function nt(t,e){const n=[];for(let o=0;o<e;o++)n[o]=tt(structuredClone(t));return n}function ot(t,e){return Math.floor(Math.random()*(e-t))+t}function st(t,e){var n;if(t<0)return st(Math.abs(t),!0);if(0===t)return"0";if(!isFinite(t))return"âˆž";const o=Math.floor(Math.log(t)/Math.log(1e3));let s;t/=Math.pow(1e3,o);var i=Math.floor(t);s=t===i?t:t.toFixed(3-i.toString().length);return`${e?"-":""}${s}${null!==(n=et[o])&&void 0!==n?n:"e"+3*o}`}var it=()=>{const t=kt.get().battle,e=kt.get().player,n=kt.get().inventories.equipment;function o(e){const n=t.grid.get()[t.grid.get().length-2].get().filter((t=>{const e=t.get().enemy;return null!=e&&!1===e.get().dead}));if(0===n.length)return!1;const o=n[ot(0,n.length)].get().enemy;return o.update((t=>(t.healthCur-=e,rt.floatingText.createBattleEnemyText(o,{text:`${e}`,speed:20,lifetime:1e3,color:"red"}),t.healthCur<=0&&(t.healthCur=0,t.dead=!0),t))),o.get().dead&&Math.random()<.2&&rt.loot.addLoot(l()),!0}function s(t){const e=[];for(let n=0;n<6;n++){let o=tt({enemy:null});const s=Math.pow(2,l()-1);if(!t&&Math.random()<1-Math.pow(.98,s)){let t=ot(1*s,5*s);s>=2&&(t*=5),o.update((e=>{let n=tt({healthCur:t,healthMax:t,damage:ot(1*s,2*s),attackClock:tt(0),attackInterval:ot(1e3,5e3),dead:!1});return e.enemy=n,e}))}e[n]=o}return e}function i(){const e=t.grid.get()[t.grid.get().length-2];for(const t of e.get()){const e=t.get().enemy;if(null!=e&&!e.get().dead)return!1}return!0}function l(){return Math.max(1,Math.ceil(t.distance.get()/100))}return{fixedUpdate:function(l){t.initialized.get()&&e.healthCur.get()>0&&function(l){e.moving.get()||i()&&e.moving.set(!0);let r=!1;if(e.moving.get()){if(t.distance.get()>e.y.get()){const t=l/1e3*e.speed.get();e.y.update((e=>e+t)),e.distanceWithoutStop.update((e=>e+t)),e.speed.set(e.curBaseSpeed.get()+e.baseSpeed.get()*e.acceleration.get()*e.distanceWithoutStop.get())}e.y.get()>=t.distance.get()&&(t.distance.update((t=>t+1)),t.grid.update((t=>(t.splice(t.length-1),t.unshift(tt(s())),t))),r=!0,i()||e.moving.set(!1))}for(const t of n.get()){const n=t.get().item;if(null==n)continue;const o=n.get().tags.weapon;o&&o.attackClock.get()<o.attackInterval&&(o.attackClock.update((t=>t+l)),o.attackClock.get()>o.attackInterval&&e.moving.get()&&o.attackClock.set(o.attackInterval))}if(!e.moving.get()){for(const t of n.get()){const e=t.get().item;if(null==e)continue;const n=e.get().tags.weapon;n&&n.attackClock.get()>=n.attackInterval&&o(n.attack)&&n.attackClock.update((t=>t-n.attackInterval))}r&&(i()?e.moving.set(!0):(e.y.set(t.distance.get()-1),e.curBaseSpeed.set(Math.max(e.baseSpeed.get(),e.speed.get()/2)),e.speed.set(e.curBaseSpeed.get()),e.distanceWithoutStop.set(0)));const s=t.grid.get()[t.grid.get().length-2];for(const n of s.get()){const o=n.get().enemy;if(null!=o&&(!o.get().dead&&(o.get().attackClock.update((t=>t+l)),o.get().attackClock.get()>o.get().attackInterval&&(o.get().attackClock.update((t=>t-o.get().attackInterval)),e.healthCur.update((t=>t-o.get().damage)),rt.floatingText.createPlayerHealthText({text:`${o.get().damage}`,speed:20,lifetime:1e3,color:"red"}),e.healthCur.get()<=0))))return void t.initialized.set(!1)}}}(l)},startRun:function(){t.initialized.set(!0),t.distance.set(1),e.y.set(0),e.acceleration.set(.5),e.baseSpeed.set(.5),e.speed.set(e.baseSpeed.get()),e.curBaseSpeed.set(.5),e.healthCur.set(e.healthMax.get()),e.distanceWithoutStop.set(0),t.grid.set(function(){let t=[];for(let e=0;e<7;e++)t[e]=tt(s());return t[7]=tt(s(!0)),t}())}}},lt=()=>{const{loot:t}=kt.get().inventories;function e(t,e,n){let o,s=1e5;o=n.minRoll?0:n.maxRoll?s:ot(0,100001),o/=s;let i=Math.pow(o,n.degree)*n.v1+n.v2*o;return i*=e-t,i+=t,Math.ceil(i)}return{addLoot:function(n){const o=function(t){const n=["weapon","helmet","chestplate","boots"],o=n[ot(0,n.length)],s={name:"Generated",type:o,tier:t,tags:{}};if("weapon"===o){let n=5*Math.pow(2,t-1),o=e(Math.floor(.5*n),Math.floor(5*n),{v1:.9,v2:.12,degree:30}),i=2500-100*e(1,20,{v1:.4,v2:.2,degree:10});s.tags.weapon={attack:o,attackClock:tt(0),attackInterval:i}}else{let n=50*Math.pow(2,t-1),o=e(Math.floor(.5*n),Math.floor(5*n),{v1:.9,v2:.12,degree:30});s.tags.armor={health:o,block:0}}return s}(n);for(let e=t.get().length-1;e>=0;e--){if(e===t.get().length-1)rt.inventory.remove(t,e);else{const n=t.get()[e].get().item;null!=n&&rt.inventory.transfer(n,t,t,e+1)}0===e&&rt.inventory.add(t,o,0)}}}};const rt={battle:null,player:null,inventory:null,windows:null,loot:null,floatingText:null},at=[],ct=[],ut=t=>null!=t.fixedUpdate,dt=t=>null!=t.init;let ft=0,pt=0;function gt(t){for(pt+=t-ft,ft=t;pt>=$t.frameTime;)pt-=$t.frameTime,mt($t.frameTime);(function(t){let e;return l(t,(t=>e=t))(),e})(kt.get().stats.timeToNextSave)<=0&&bt(),requestAnimationFrame(gt)}function mt(t){kt.get().stats.timeElapsedSession.update((e=>e+t)),kt.get().stats.timeElapsedTotal.update((e=>e+t)),kt.get().stats.timeToNextSave.update((e=>e-t));for(const e of at)e.fixedUpdate(t)}function ht(t){rt.battle=it(),rt.player=(()=>{const t=kt.get().player,e=xt.get().player,{equipment:n}=kt.get().inventories;function o(){var e,o;console.log("recalculate stats");let s=0,i=0;for(const t of n.get()){const n=t.get().item;if(null==n)continue;const l=n.get();null!=l.tags.armor&&(s+=null!==(e=l.tags.armor.health)&&void 0!==e?e:0,i+=null!==(o=l.tags.armor.block)&&void 0!==o?o:0)}t.healthMax.set(s),t.healthMax.get()>s&&t.healthCur.set(s),t.block.set(i)}function s(){for(const t of Object.keys(e.minStats)){let n=1/0,o=0,s=1/0,i=1/0;for(let e of kt.get().inventories.equipment.get().filter((e=>e.get().types.includes(t)))){const t=e.get().item;if(null==t)continue;const l=t.get();if(l.tags.weapon){const t=l.tags.weapon;n>t.attack&&(n=t.attack),o<t.attackInterval&&(o=t.attackInterval)}if(l.tags.armor){const t=l.tags.armor;s>t.health&&(s=t.health),i>t.block&&(i=t.block)}}e.minStats[t].set({attack:n===1/0?0:n,attackInterval:0===o?1/0:o,health:s===1/0?0:s,block:i===1/0?0:i})}}return{init:function(){n.subscribe((t=>{for(let e of t)e.subscribe(s),e.subscribe(o)}))}}})(),rt.inventory=(()=>{function t(t){const e=t.get(),n=e.tags.weapon;null!=n&&n.attackClock.get()>0&&(n.attackClock.set(0),t.set(e))}return{itemAt:function(t,e){const n=t.get()[e];if(null==n)return null;const o=n.get().item;return null==o?null:o},add:function(t,e,n){const o=null==n?function(t){for(const[e,n]of t.get().entries())if(null==n.get().item)return e;return null}(t):n;if(null==o)return!1;const s=t.get()[o];return!(null==s||null!=s.get().item||s.get().types.length>0&&!s.get().types.includes(e.type)||(s.update((t=>(t.item=tt(e),t))),0))},remove:function(t,e){const n=t.get()[e];return null!=n&&null!=n.get().item&&(n.update((t=>(t.item=null,t))),!0)},transfer:function(e,n,o,s){const i=n.get().findIndex((t=>t.get().item===e));if(-1===i)return!1;const l=n.get()[i],r=o.get()[s];if(null==r)return!1;const a=r.get().item;return!(null!=a&&l.get().types.length>0&&!l.get().types.includes(a.get().type)||r.get().types.length>0&&!r.get().types.includes(e.get().type)||(t(e),a&&t(a),l.update((t=>(t.item=a,t))),r.update((t=>(t.item=e,t))),0))}}})(),rt.windows=(()=>{const t=kt.get().windows;function e(e,n){n&&t.get().filter((t=>!0===t.get().selected)).forEach((t=>t.update((t=>(t.selected=!1,t))))),e.update((t=>(t.selected=n,t)))}function n(t,e){t.update((t=>(t.minimized=e,t)))}return{create:function(o,s){var i,l,r,a;const c=null!==(i=null==s?void 0:s.pos)&&void 0!==i?i:{x:300*Math.random()+100,y:300*Math.random()+100};let u=null===(l=null==s?void 0:s.resizable)||void 0===l||l;if("auto"!==o.size.x&&"auto"!==o.size.y||(u=!1),null!=o.id){const s=t.get().find((t=>t.get().id===o.id));if(null!=s)return e(s,!0),n(s,!1),!0}const d=tt(Object.assign(Object.assign({},o),{selected:!1,minimized:!1,pos:c,initialPos:c,resizable:u}));return t.update((t=>(t.push(d),t))),e(d,null===(r=null==s?void 0:s.selected)||void 0===r||r),n(d,null!==(a=null==s?void 0:s.minimized)&&void 0!==a&&a),!0},remove:function(e){const n=t.get().findIndex((t=>t===e));return-1!==n&&(t.update((t=>(t.splice(n,1),t))),!0)},removeAll:function(){t.update((t=>[]))},select:function(n,o){const s=t.get().find((t=>t===n));return null!=s&&(e(s,o),!0)},deselectAll:function(){t.get().filter((t=>!0===t.get().selected)).forEach((t=>t.update((t=>(t.selected=!1,t)))))},move:function(e,n){const o=t.get().find((t=>t===e));return null!=o&&(o.update((t=>(t.pos=n,t))),!0)},minimize:function(e,o){const s=t.get().find((t=>t===e&&t.get().minimized!==o));if(null==s)return!1;n(s,o)},resize:function(e,n){const o=t.get().find((t=>t===e));return null!=o&&(o.update((t=>(t.size=n,t))),!0)}}})(),rt.loot=lt(),rt.floatingText=(()=>{const t=xt.get().elems,e=xt.get().floatingText;return{fixedUpdate:function(t){for(let n=0;n<e.get().length;n++){const o=e.get()[n];o.get().lifetime-=t,o.get().y.update((e=>e-o.get().speed*(t/1e3))),o.get().lifetime<0&&(e.update((t=>(t.splice(n,1),t))),n--)}},createBattleEnemyText:function(n,o){const s=t.battleEnemies.get(n);if(null==s)return;const i=s.getBoundingClientRect(),l=i.x+i.width/2,r=i.y+i.height/2-24;e.update((t=>{const e={x:l,y:tt(r),speed:o.speed,text:o.text,lifetime:o.lifetime};return null!=o.color&&(e.color=o.color),null!=o.stylingClass&&(e.stylingClass=o.stylingClass),t.push(tt(e)),t}))},createPlayerHealthText:function(n){const o=t.playerHealth;if(null==o)return;const s=o.getBoundingClientRect(),i=s.x+s.width/2,l=s.y+s.height/2-24;e.update((t=>{const e={x:i,y:tt(l),speed:n.speed,text:n.text,lifetime:n.lifetime};return null!=n.color&&(e.color=n.color),null!=n.stylingClass&&(e.stylingClass=n.stylingClass),t.push(tt(e)),t}))}}})(),at.splice(0,at.length),at.push(...Object.values(rt).filter(ut)),ct.splice(0,ct.length),ct.push(...Object.values(rt).filter(dt));for(const t of ct)t.init();console.info("Managers reinitialized."),t&&(rt.windows.create({id:"backpack",panel:"backpack",size:{x:352,y:306},title:"Backpack"},{pos:{x:110,y:264}}),rt.windows.create({id:"equipment",panel:"equipment",size:{x:211,y:234},title:"Equipment"},{pos:{x:110,y:24}}),rt.windows.create({id:"loot",panel:"loot",size:{x:695,y:102},title:"Loot"},{pos:{x:378,y:46}}),rt.windows.create({id:"battle",panel:"battle",size:{x:595,y:417},title:"Battle"},{pos:{x:478,y:153}}))}const vt="save",$t={version:15,itemSize:64,saveInterval:1e4,frameTime:30},wt={version:tt($t.version),stats:{timeElapsedSession:tt(0),timeElapsedTotal:tt(0),timeToNextSave:tt($t.saveInterval)},windows:tt([]),inventories:{cursor:tt([tt({types:[],item:null})]),backpack:tt(nt({types:[],item:null},20)),loot:tt(nt({types:[],item:null},10)),equipment:tt([tt({types:["weapon"],item:tt({name:"Sword",type:"weapon",tier:0,tags:{weapon:{attack:1,attackClock:tt(0),attackInterval:3e3}}})}),tt({types:["weapon"],item:null}),tt({types:["helmet"],item:null}),tt({types:["chestplate"],item:null}),tt({types:["boots"],item:tt({name:"Boots",type:"boots",tier:0,tags:{armor:{block:0,health:30}}})})])},battle:{distance:tt(0),initialized:tt(!1),grid:tt([])},player:{moving:tt(!1),y:tt(0),baseSpeed:tt(0),curBaseSpeed:tt(0),speed:tt(0),acceleration:tt(0),healthCur:tt(0),healthMax:tt(0),block:tt(0),distanceWithoutStop:tt(0)},world:{}},yt={player:{minStats:{weapon:tt({attack:0,attackInterval:0,health:0,block:0}),helmet:tt({attack:0,attackInterval:0,health:0,block:0}),chestplate:tt({attack:0,attackInterval:0,health:0,block:0}),boots:tt({attack:0,attackInterval:0,health:0,block:0})}},elems:{battleEnemies:new Map,playerHealth:null},floatingText:tt([])},xt=tt(yt),kt=tt(wt);function bt(){kt.get().stats.timeToNextSave.set($t.saveInterval);const t=Ct(kt.get(),{});localStorage.setItem(vt,Z.compressToBase64(JSON.stringify(t)))}function zt(t,e){let n=(()=>{let e=null!=t?t:localStorage.getItem(vt);if(null==e||0==e.length)return!1;if(e=Z.decompressFromBase64(e),null==e||0==e.length)return!1;const n=Mt(JSON.parse(e),{});if(n.version.get()!=kt.get().version.get())return!1;for(let t=0;t<n.windows.get().length;t++){const e=n.windows.get()[t].get().id;"save_import"!==e&&"save_export"!==e||(n.windows.get().splice(t,1),t--)}return xt.set(yt),kt.set(n),console.info("Load from local storage %csuccessful%c.","color: green"),!0})();return e&&!n?(console.info("Soft load %cfailed%c.","color: orange"),!1):(n||(xt.set(yt),kt.set(wt),console.info("Load from local storage %cfailed%c. Starting a new game.","color: orange")),ht(!n),!0)}function Ct(t,e){const n=Object.keys(t);for(const o of n){let n,s=!1;t[o]&&"function"==typeof t[o].get?(n=t[o].get(),s=!0):n=t[o],s?(e[o]={},null!=n&&"object"==typeof n?(e[o].$store=n instanceof Array?[]:{},e[o].$store=Ct(n,e[o].$store)):e[o].$store=n):null!=n&&"object"==typeof n?(e[o]=n instanceof Array?[]:{},e[o]=Ct(n,e[o])):e[o]=n}return e}function Mt(t,e){const n=Object.keys(t);for(const o of n){let n,s=!1;t[o]&&null!=t[o].$store?(n=t[o].$store,s=!0):n=t[o],null!=n&&"object"==typeof n?(e[o]=n instanceof Array?[]:{},e[o]=Mt(n,e[o]),s&&(e[o]=tt(e[o]))):(e[o]=n,s&&(e[o]=tt(n)))}return e}window.game=kt,window.temp=xt;const St=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,It=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,_t=function(t){t=t.replace(St,((t,e,n,o)=>e+e+n+n+o+o));var e=It.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:0,g:0,b:0}},Tt=(()=>{let t=(t,e,n)=>(e-t)/6/n+.5,e=t=>Math.round(100*t)/100;return function(n){let o,s,i,l,r=0,a=n.r/255,c=n.g/255,u=n.b/255,d=Math.max(a,c,u),f=d-Math.min(a,c,u);return 0==f?r=l=0:(l=f/d,o=t(a,d,f),s=t(c,d,f),i=t(u,d,f),a===d?r=i-s:c===d?r=1/3+o-i:u===d&&(r=2/3+s-o),r<0?r+=1:r>1&&(r-=1)),{h:Math.round(360*r),s:e(100*l),v:e(100*d)}}})(),Ot=function(t){let e=t.h/360,n=t.s/100,o=t.v/100,s=0,i=0,l=0,r=Math.floor(6*e),a=6*e-r,c=o*(1-n),u=o*(1-a*n),d=o*(1-(1-a)*n);switch(r%6){case 0:s=o,i=d,l=c;break;case 1:s=u,i=o,l=c;break;case 2:s=c,i=o,l=d;break;case 3:s=c,i=u,l=o;break;case 4:s=d,i=c,l=o;break;case 5:s=o,i=c,l=u}return{r:Math.round(255*s),b:Math.round(255*l),g:Math.round(255*i)}},Et=function(t,e,n){let o=e.h-t.h,s=o+(Math.abs(o)>180?o<0?360:-360:0);return{h:Math.round((t.h+s*n+360)%360),s:Math.round((e.s-t.s)*n+t.s),v:Math.round((e.v-t.v)*n+t.v)}};function Bt(e){let n;return{c(){n=f("div"),v(n,"class","sky svelte-m2lq24"),y(n,"background",e[0])},m(t,e){c(t,n,e)},p(t,[e]){1&e&&y(n,"background",t[0])},i:t,o:t,d(t){t&&u(n)}}}function qt(t,e,n){let o=new Map;o.set(5.5,{colors:[_t("#0D0807"),_t("#0D0807")],brightness:.55}),o.set(7,{colors:[_t("#855256"),_t("#FF6D50")],brightness:.8}),o.set(8,{colors:[_t("#3B77B2"),_t("#82A9BB")],brightness:.95}),o.set(15,{colors:[_t("#3B77B2"),_t("#82A9BB")],brightness:.95}),o.set(18,{colors:[_t("#7595C0"),_t("#8C6E6E")],brightness:.85}),o.set(20,{colors:[_t("#4B65A8"),_t("#274371")],brightness:.75}),o.set(22,{colors:[_t("#001D54"),_t("#03224D")],brightness:.65}),o.set(23,{colors:[_t("#0D0807"),_t("#0D0807")],brightness:.55});let s="";return function t(){(function(t){let e=t.getHours()+t.getMinutes()/60,i=Array.from(o.keys());i.sort(((t,e)=>t-e));let l=0,r=0,a=0;for(let t=0,n=i.length;t<n&&(l=i[t],r=null==i[t+1]?i[0]:i[t+1],a=r<l?24:0,!(e>=l&&e<=r+a));t++);let c=o.get(l),u=o.get(r);if(!c||!u)return;let d=[],f=1-(r+a-(e<l?e+24:e))/(r+a-l);for(let t=0,e=Math.max(c.colors.length,u.colors.length);t<e;t++){let e=c.colors[t]||c.colors[c.colors.length-1],n=u.colors[t]||u.colors[u.colors.length-1],o=Tt(e),s=Tt(n),i=Et(o,s,f);d.push(Ot(i)),u.brightness,c.brightness,c.brightness}n(0,s=`linear-gradient(${d.map((t=>`rgb(${t.r},${t.g},${t.b})`)).join(", ")})`)})(new Date(Date.now()+0)),setTimeout((()=>t()),1e3)}(),[s]}class At extends V{constructor(t){super(),K(this,t,qt,Bt,i,{})}}function Pt(e){let n,o,s,i,l,r,d,m,w,x,k=e[1].char+"",b=`${e[1].size}px`,z=`${e[2].x}px`,C=`${e[2].y}px`;return{c(){n=f("div"),o=f("div"),s=f("div"),i=f("div"),l=p(k),r=g(),d=f("div"),m=p(e[0]),v(i,"class","inner2 svelte-tzumok"),v(s,"class","inner svelte-tzumok"),v(o,"class","image svelte-tzumok"),y(o,"fontSize",b,!1),v(d,"class","name svelte-tzumok"),v(n,"class","icon svelte-tzumok"),y(n,"left",z,!1),y(n,"top",C,!1)},m(t,u){c(t,n,u),a(n,o),a(o,s),a(s,i),a(i,l),a(n,r),a(n,d),a(d,m),w||(x=h(n,"click",e[3]),w=!0)},p(t,[e]){2&e&&k!==(k=t[1].char+"")&&$(l,k),2&e&&b!==(b=`${t[1].size}px`)&&y(o,"fontSize",b,!1),1&e&&$(m,t[0]),4&e&&z!==(z=`${t[2].x}px`)&&y(n,"left",z,!1),4&e&&C!==(C=`${t[2].y}px`)&&y(n,"top",C,!1)},i:t,o:t,d(t){t&&u(n),w=!1,x()}}}function Dt(t,e,n){let{name:o}=e,{icon:s}=e,{pos:i}=e,{onClick:l}=e;return t.$$set=t=>{"name"in t&&n(0,o=t.name),"icon"in t&&n(1,s=t.icon),"pos"in t&&n(2,i=t.pos),"onClick"in t&&n(4,l=t.onClick)},[o,s,i,function(t){l&&l(),t.stopPropagation()},l]}class Nt extends V{constructor(t){super(),K(this,t,Dt,Pt,i,{name:0,icon:1,pos:2,onClick:4})}}function jt(t,e,n){const o=t.slice();return o[1]=e[n],o[3]=n,o}function Xt(e){let n,o;return n=new Nt({props:{name:e[1].name,icon:{size:26,char:e[1].icon},pos:{x:20,y:20+80*e[3]},onClick:e[1].onClick}}),{c(){W(n.$$.fragment)},m(t,e){H(n,t,e),o=!0},p:t,i(t){o||(R(n.$$.fragment,t),o=!0)},o(t){Y(n.$$.fragment,t),o=!1},d(t){G(n,t)}}}function Lt(t){let e,n,o,s,i=t[0],l=[];for(let e=0;e<i.length;e+=1)l[e]=Xt(jt(t,i,e));const r=t=>Y(l[t],1,1,(()=>{l[t]=null}));return{c(){e=f("div");for(let t=0;t<l.length;t+=1)l[t].c();n=g(),o=f("div"),o.textContent="This game is in pre-alpha. Your save will be deleted by future updates.",v(o,"class","disclaimer svelte-kdg39"),v(e,"class","desktop svelte-kdg39")},m(t,i){c(t,e,i);for(let t=0;t<l.length;t+=1)l[t].m(e,null);a(e,n),a(e,o),s=!0},p(t,[o]){if(1&o){let s;for(i=t[0],s=0;s<i.length;s+=1){const r=jt(t,i,s);l[s]?(l[s].p(r,o),R(l[s],1)):(l[s]=Xt(r),l[s].c(),R(l[s],1),l[s].m(e,n))}for(Q(),s=i.length;s<l.length;s+=1)r(s);U()}},i(t){if(!s){for(let t=0;t<i.length;t+=1)R(l[t]);s=!0}},o(t){l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)Y(l[t]);s=!1},d(t){t&&u(e),d(l,t)}}}function Qt(t){return[[{name:"Backpack",icon:"B",onClick:()=>rt.windows.create({id:"backpack",panel:"backpack",size:{x:352,y:306},title:"Backpack"})},{name:"Equipment",icon:"E",onClick:()=>rt.windows.create({id:"equipment",panel:"equipment",size:{x:211,y:234},title:"Equipment"})},{name:"Loot",icon:"G",onClick:()=>rt.windows.create({id:"loot",panel:"loot",size:{x:695,y:102},title:"Loot"})},{name:"Debug",icon:"D",onClick:()=>rt.windows.create({id:"debug",panel:"debug",size:{x:300,y:300},title:"Debug"})},{name:"Battle",icon:"B",onClick:()=>rt.windows.create({id:"battle",panel:"battle",size:{x:595,y:417},title:"Battle"})},{name:"Fight",icon:"F",onClick:()=>rt.battle.startRun()}]]}class Ut extends V{constructor(t){super(),K(this,t,Qt,Lt,i,{})}}function Rt(t){let e,n,o,s,i,l,r,d,m,h,w,y,x,k=st(t[2].tags.armor.health)+"",b=st(t[2].tags.armor.block)+"";return{c(){e=f("div"),n=f("div"),o=g(),s=f("div"),i=p(k),r=g(),d=f("div"),m=f("div"),h=g(),w=f("div"),y=p(b),v(n,"class","stat-icon icon-itemstats icon-itemstats-health svelte-dy6po2"),v(s,"class",l="item-value "+t[3].health+" svelte-dy6po2"),v(e,"class","item-row svelte-dy6po2"),v(m,"class","stat-icon icon-itemstats icon-itemstats-block svelte-dy6po2"),v(w,"class",x="item-value "+t[3].block+" svelte-dy6po2"),v(d,"class","item-row svelte-dy6po2")},m(t,l){c(t,e,l),a(e,n),a(e,o),a(e,s),a(s,i),c(t,r,l),c(t,d,l),a(d,m),a(d,h),a(d,w),a(w,y)},p(t,e){4&e&&k!==(k=st(t[2].tags.armor.health)+"")&&$(i,k),8&e&&l!==(l="item-value "+t[3].health+" svelte-dy6po2")&&v(s,"class",l),4&e&&b!==(b=st(t[2].tags.armor.block)+"")&&$(y,b),8&e&&x!==(x="item-value "+t[3].block+" svelte-dy6po2")&&v(w,"class",x)},d(t){t&&u(e),t&&u(r),t&&u(d)}}}function Yt(t){let e,n,o,s,i,l,r,d,m,h,w,y,x,k,b=st(t[2].tags.weapon.attack)+"",z=Math.floor(1e3/t[2].tags.weapon.attackInterval*100)/100+"",C=t[6]&&Ft(t);return{c(){C&&C.c(),e=g(),n=f("div"),o=f("div"),s=g(),i=f("div"),l=p(b),d=g(),m=f("div"),h=f("div"),w=g(),y=f("div"),x=p(z),v(o,"class","stat-icon icon-itemstats icon-itemstats-attack svelte-dy6po2"),v(i,"class",r="item-value "+t[3].attack+" svelte-dy6po2"),v(n,"class","item-row svelte-dy6po2"),v(h,"class","stat-icon icon-itemstats icon-itemstats-attackSpeed svelte-dy6po2"),v(y,"class",k="item-value "+t[3].attackInterval+" svelte-dy6po2"),v(m,"class","item-row svelte-dy6po2")},m(t,r){C&&C.m(t,r),c(t,e,r),c(t,n,r),a(n,o),a(n,s),a(n,i),a(i,l),c(t,d,r),c(t,m,r),a(m,h),a(m,w),a(m,y),a(y,x)},p(t,n){t[6]?C?C.p(t,n):(C=Ft(t),C.c(),C.m(e.parentNode,e)):C&&(C.d(1),C=null),4&n&&b!==(b=st(t[2].tags.weapon.attack)+"")&&$(l,b),8&n&&r!==(r="item-value "+t[3].attack+" svelte-dy6po2")&&v(i,"class",r),4&n&&z!==(z=Math.floor(1e3/t[2].tags.weapon.attackInterval*100)/100+"")&&$(x,z),8&n&&k!==(k="item-value "+t[3].attackInterval+" svelte-dy6po2")&&v(y,"class",k)},d(t){C&&C.d(t),t&&u(e),t&&u(n),t&&u(d),t&&u(m)}}}function Ft(t){let e,n=`translateX(${100-t[6]/t[2].tags.weapon.attackInterval*100}%)`;return{c(){e=f("div"),v(e,"class","attack-progress svelte-dy6po2"),y(e,"transform",n,!1)},m(t,n){c(t,e,n)},p(t,o){68&o&&n!==(n=`translateX(${100-t[6]/t[2].tags.weapon.attackInterval*100}%)`)&&y(e,"transform",n,!1)},d(t){t&&u(e)}}}function Wt(e){let n,o,s,i,l,r=e[2].type+"",d=`${$t.itemSize}px`,m=`${$t.itemSize}px`,h=e[2].tags.armor&&Rt(e),w=e[2].tags.weapon&&Yt(e);return{c(){n=f("div"),o=f("div"),s=p(r),i=g(),h&&h.c(),l=g(),w&&w.c(),v(o,"class","name-type svelte-dy6po2"),v(n,"class","item svelte-dy6po2"),y(n,"width",d,!1),y(n,"height",m,!1),y(n,"opacity",e[1]?"0.5":"1",!1)},m(t,e){c(t,n,e),a(n,o),a(o,s),a(n,i),h&&h.m(n,null),a(n,l),w&&w.m(n,null)},p(t,[e]){4&e&&r!==(r=t[2].type+"")&&$(s,r),t[2].tags.armor?h?h.p(t,e):(h=Rt(t),h.c(),h.m(n,l)):h&&(h.d(1),h=null),t[2].tags.weapon?w?w.p(t,e):(w=Yt(t),w.c(),w.m(n,null)):w&&(w.d(1),w=null),2&e&&y(n,"opacity",t[1]?"0.5":"1",!1)},i:t,o:t,d(t){t&&u(n),h&&h.d(),w&&w.d()}}}function Ht(e,n,o){let s,i,r,a,c,u=t,d=()=>(u(),u=l(m,(t=>o(2,r=t))),m),f=t,p=t;var g;e.$$.on_destroy.push((()=>u())),e.$$.on_destroy.push((()=>f())),e.$$.on_destroy.push((()=>p()));let{item:m}=n;d();let{slot:h}=n,{inventoryId:v}=n,{transparent:$}=n;const w=xt.get().player;let y="equipment"!==v,x={attack:"",attackInterval:"",health:"",block:""};return e.$$set=t=>{"item"in t&&d(o(0,m=t.item)),"slot"in t&&o(7,h=t.slot),"inventoryId"in t&&o(8,v=t.inventoryId),"transparent"in t&&o(1,$=t.transparent)},e.$$.update=()=>{if(4&e.$$.dirty&&(o(5,s=w.minStats[r.type]),f(),f=l(s,(t=>o(10,a=t)))),1028&e.$$.dirty){o(3,x={attack:"",attackInterval:"",health:"",block:""});const t=r.tags;y&&(t.weapon&&(t.weapon.attack>a.attack?o(3,x.attack="green",x):t.weapon.attack<a.attack&&o(3,x.attack="red",x),t.weapon.attackInterval<a.attackInterval?o(3,x.attackInterval="green",x):t.weapon.attackInterval>a.attackInterval&&o(3,x.attackInterval="red",x)),t.armor&&(t.armor.health>a.health?o(3,x.health="green",x):t.armor.health<a.health&&o(3,x.health="red",x),t.armor.block>a.block?o(3,x.block="green",x):t.armor.block<a.block&&o(3,x.block="red",x)))}516&e.$$.dirty&&(o(4,i=null===o(9,g=r.tags.weapon)||void 0===g?void 0:g.attackClock),p(),p=l(i,(t=>o(6,c=t))))},[m,$,r,x,i,s,c,h,v,g,a]}class Gt extends V{constructor(t){super(),K(this,t,Ht,Wt,i,{item:0,slot:7,inventoryId:8,transparent:1})}}function Jt(t,e,n){const o=t.slice();return o[14]=e[n],o}function Kt(e){let n,o=e[2].types,s=[];for(let t=0;t<o.length;t+=1)s[t]=Zt(Jt(e,o,t));return{c(){n=f("div");for(let t=0;t<s.length;t+=1)s[t].c();v(n,"class","name-type svelte-1vpmx2y")},m(t,e){c(t,n,e);for(let t=0;t<s.length;t+=1)s[t].m(n,null)},p(t,e){if(4&e){let i;for(o=t[2].types,i=0;i<o.length;i+=1){const l=Jt(t,o,i);s[i]?s[i].p(l,e):(s[i]=Zt(l),s[i].c(),s[i].m(n,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=o.length}},i:t,o:t,d(t){t&&u(n),d(s,t)}}}function Vt(t){let e,n;return e=new Gt({props:{item:t[4],inventoryId:t[0],slot:t[1],transparent:""!==t[3]}}),{c(){W(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};16&n&&(o.item=t[4]),1&n&&(o.inventoryId=t[0]),2&n&&(o.slot=t[1]),8&n&&(o.transparent=""!==t[3]),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){Y(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Zt(t){let e,n,o=t[14]+"";return{c(){e=f("div"),n=p(o),v(e,"class","slot-type")},m(t,o){c(t,e,o),a(e,n)},p(t,e){4&e&&o!==(o=t[14]+"")&&$(n,o)},d(t){t&&u(e)}}}function te(t){let e,n,s,i,l,r,a=`${$t.itemSize}px`,d=`${$t.itemSize}px`;const p=[Vt,Kt],g=[];function m(t,e){return null!=t[4]?0:1}return n=m(t),s=g[n]=p[n](t),{c(){e=f("div"),s.c(),v(e,"class","item-slot svelte-1vpmx2y"),y(e,"width",a,!1),y(e,"height",d,!1),y(e,"background-color",t[3],!1),y(e,"cursor",null==t[6].item?"":"pointer",!1)},m(o,s){c(o,e,s),g[n].m(e,null),i=!0,l||(r=[h(e,"mouseenter",t[9]),h(e,"mouseleave",t[10]),h(e,"click",t[8])],l=!0)},p(t,[o]){let i=n;n=m(t),n===i?g[n].p(t,o):(Q(),Y(g[i],1,1,(()=>{g[i]=null})),U(),s=g[n],s?s.p(t,o):(s=g[n]=p[n](t),s.c()),R(s,1),s.m(e,null)),8&o&&y(e,"background-color",t[3],!1),64&o&&y(e,"cursor",null==t[6].item?"":"pointer",!1)},i(t){i||(R(s),i=!0)},o(t){Y(s),i=!1},d(t){t&&u(e),g[n].d(),l=!1,o(r)}}}function ee(e,n,o){let s,i,a,c,u,d,f=t,p=t,g=()=>(p(),p=l(h,(t=>o(2,u=t))),h);e.$$.on_destroy.push((()=>f())),e.$$.on_destroy.push((()=>p()));let{id:m}=n,{slot:h}=n;g();let{slotIndex:v}=n;const{cursor:$}=kt.get().inventories;r(e,$,(t=>o(12,d=t)));let w="";return e.$$set=t=>{"id"in t&&o(0,m=t.id),"slot"in t&&g(o(1,h=t.slot)),"slotIndex"in t&&o(11,v=t.slotIndex)},e.$$.update=()=>{1&e.$$.dirty&&(s=kt.get().inventories[m]),4&e.$$.dirty&&o(4,i=u.item),4096&e.$$.dirty&&(o(5,a=d[0]),f(),f=l(a,(t=>o(6,c=t))))},[m,h,u,w,i,a,c,$,function(t){if(t.stopPropagation(),null!=i){if(t.shiftKey)return void rt.inventory.remove(s,v);rt.inventory.transfer(i,s,$,0)}else{if(null==c.item)return;rt.inventory.transfer(c.item,$,s,v)&&o(3,w="")}},function(t){null==c.item?o(3,w=""):u.types.length>0&&!u.types.includes(c.item.get().type)?o(3,w="#b53b3b"):o(3,w="#378e37")},function(t){o(3,w="")},v,d]}class ne extends V{constructor(t){super(),K(this,t,ee,te,i,{id:0,slot:1,slotIndex:11})}}function oe(t,e,n){const o=t.slice();return o[5]=e[n],o[7]=n,o}function se(t){let e,n,o,s,i=`${$t.itemSize}px`,l=`${$t.itemSize}px`;return n=new ne({props:{id:"backpack",slotIndex:t[7],slot:t[5]}}),{c(){e=f("div"),W(n.$$.fragment),o=g(),v(e,"class","slot-container svelte-qo3i7m"),y(e,"width",i,!1),y(e,"height",l,!1)},m(t,i){c(t,e,i),H(n,e,null),a(e,o),s=!0},p(t,e){const o={};2&e&&(o.slot=t[5]),n.$set(o)},i(t){s||(R(n.$$.fragment,t),s=!0)},o(t){Y(n.$$.fragment,t),s=!1},d(t){t&&u(e),G(n)}}}function ie(t){let e,n,o=t[1],s=[];for(let e=0;e<o.length;e+=1)s[e]=se(oe(t,o,e));const i=t=>Y(s[t],1,1,(()=>{s[t]=null}));return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=m()},m(t,o){for(let e=0;e<s.length;e+=1)s[e].m(t,o);c(t,e,o),n=!0},p(t,[n]){if(2&n){let l;for(o=t[1],l=0;l<o.length;l+=1){const i=oe(t,o,l);s[l]?(s[l].p(i,n),R(s[l],1)):(s[l]=se(i),s[l].c(),R(s[l],1),s[l].m(e.parentNode,e))}for(Q(),l=o.length;l<s.length;l+=1)i(l);U()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)R(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)Y(s[t]);n=!1},d(t){d(s,t),t&&u(e)}}}function le(e,n,o){let s,i,a=t,c=()=>(a(),a=l(u,(t=>o(3,s=t))),u);e.$$.on_destroy.push((()=>a()));let{window:u}=n;c();const{backpack:d}=kt.get().inventories;return r(e,d,(t=>o(1,i=t))),e.$$set=t=>{"window"in t&&c(o(0,u=t.window))},e.$$.update=()=>{e.$$.dirty},[u,i,d,s]}class re extends V{constructor(t){super(),K(this,t,le,ie,i,{window:0})}}function ae(e){let n,o,s,i,l,r,d,m,h,v,w,y,x,k,b;return{c(){n=f("div"),o=p("Elapsed total: "),s=p(e[1]),i=g(),l=f("div"),r=p("Elapsed in session: "),d=p(e[2]),m=g(),h=f("div"),v=p("Until next save: "),w=p(e[3]),y=g(),x=f("div"),k=p("Player distance: "),b=p(e[4])},m(t,e){c(t,n,e),a(n,o),a(n,s),c(t,i,e),c(t,l,e),a(l,r),a(l,d),c(t,m,e),c(t,h,e),a(h,v),a(h,w),c(t,y,e),c(t,x,e),a(x,k),a(x,b)},p(t,[e]){2&e&&$(s,t[1]),4&e&&$(d,t[2]),8&e&&$(w,t[3]),16&e&&$(b,t[4])},i:t,o:t,d(t){t&&u(n),t&&u(i),t&&u(l),t&&u(m),t&&u(h),t&&u(y),t&&u(x)}}}function ce(e,n,o){let s,i,a,c,u,d=t,f=()=>(d(),d=l(p,(t=>o(9,s=t))),p);e.$$.on_destroy.push((()=>d()));let{window:p}=n;f();const{timeElapsedTotal:g,timeElapsedSession:m,timeToNextSave:h}=kt.get().stats;r(e,g,(t=>o(1,i=t))),r(e,m,(t=>o(2,a=t))),r(e,h,(t=>o(3,c=t)));const{y:v}=kt.get().player;return r(e,v,(t=>o(4,u=t))),e.$$set=t=>{"window"in t&&f(o(0,p=t.window))},e.$$.update=()=>{e.$$.dirty},[p,i,a,c,u,g,m,h,v,s]}class ue extends V{constructor(t){super(),K(this,t,ce,ae,i,{window:0})}}function de(t,e,n){const o=t.slice();return o[6]=e[n],o[8]=n,o}function fe(t){let e,n,o,s,i=`${$t.itemSize}px`,l=`${$t.itemSize}px`,r=`${t[3][t[8]].x}px`,d=`${t[3][t[8]].y}px`;return n=new ne({props:{id:"equipment",slotIndex:t[8],slot:t[6]}}),{c(){e=f("div"),W(n.$$.fragment),o=g(),v(e,"class","slot-container svelte-19crgj5"),y(e,"width",i,!1),y(e,"height",l,!1),y(e,"left",r,!1),y(e,"top",d,!1)},m(t,i){c(t,e,i),H(n,e,null),a(e,o),s=!0},p(t,e){const o={};2&e&&(o.slot=t[6]),n.$set(o)},i(t){s||(R(n.$$.fragment,t),s=!0)},o(t){Y(n.$$.fragment,t),s=!1},d(t){t&&u(e),G(n)}}}function pe(t){let e,n,o=t[1],s=[];for(let e=0;e<o.length;e+=1)s[e]=fe(de(t,o,e));const i=t=>Y(s[t],1,1,(()=>{s[t]=null}));return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=m()},m(t,o){for(let e=0;e<s.length;e+=1)s[e].m(t,o);c(t,e,o),n=!0},p(t,[n]){if(10&n){let l;for(o=t[1],l=0;l<o.length;l+=1){const i=de(t,o,l);s[l]?(s[l].p(i,n),R(s[l],1)):(s[l]=fe(i),s[l].c(),R(s[l],1),s[l].m(e.parentNode,e))}for(Q(),l=o.length;l<s.length;l+=1)i(l);U()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)R(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)Y(s[t]);n=!1},d(t){d(s,t),t&&u(e)}}}function ge(e,n,o){let s,i,a=t,c=()=>(a(),a=l(u,(t=>o(4,s=t))),u);e.$$.on_destroy.push((()=>a()));let{window:u}=n;c();const{equipment:d}=kt.get().inventories;r(e,d,(t=>o(1,i=t)));return e.$$set=t=>{"window"in t&&c(o(0,u=t.window))},e.$$.update=()=>{e.$$.dirty},[u,i,d,[{x:0,y:66},{x:132,y:66},{x:66,y:0},{x:66,y:66},{x:66,y:132}],s]}class me extends V{constructor(t){super(),K(this,t,ge,pe,i,{window:0})}}function he(e){let n,o,i,l;return{c(){n=f("div"),o=p(e[0]),v(n,"class","button svelte-o7hrlv")},m(t,r){c(t,n,r),a(n,o),i||(l=h(n,"click",(function(){s(e[1])&&e[1].apply(this,arguments)})),i=!0)},p(t,[n]){e=t,1&n&&$(o,e[0])},i:t,o:t,d(t){t&&u(n),i=!1,l()}}}function ve(t,e,n){let{name:o}=e,{onClick:s}=e;return t.$$set=t=>{"name"in t&&n(0,o=t.name),"onClick"in t&&n(1,s=t.onClick)},[o,s]}class $e extends V{constructor(t){super(),K(this,t,ve,he,i,{name:0,onClick:1})}}function we(t,e,n){const o=t.slice();return o[1]=e[n],o}function ye(t){let e,n,o=t[0],s=[];for(let e=0;e<o.length;e+=1)s[e]=xe(we(t,o,e));const i=t=>Y(s[t],1,1,(()=>{s[t]=null}));return{c(){e=f("div");for(let t=0;t<s.length;t+=1)s[t].c();v(e,"class","buttons svelte-xxps72")},m(t,o){c(t,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,n){if(1&n){let l;for(o=t[0],l=0;l<o.length;l+=1){const i=we(t,o,l);s[l]?(s[l].p(i,n),R(s[l],1)):(s[l]=xe(i),s[l].c(),R(s[l],1),s[l].m(e,null))}for(Q(),l=o.length;l<s.length;l+=1)i(l);U()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)R(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)Y(s[t]);n=!1},d(t){t&&u(e),d(s,t)}}}function xe(t){let e,n;return e=new $e({props:{name:t[1].name,onClick:t[1].onClick}}),{c(){W(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.name=t[1].name),1&n&&(o.onClick=t[1].onClick),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){Y(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function ke(t){let e,n,o=t[0].length>0&&ye(t);return{c(){o&&o.c(),e=m()},m(t,s){o&&o.m(t,s),c(t,e,s),n=!0},p(t,[n]){t[0].length>0?o?(o.p(t,n),1&n&&R(o,1)):(o=ye(t),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(Q(),Y(o,1,1,(()=>{o=null})),U())},i(t){n||(R(o),n=!0)},o(t){Y(o),n=!1},d(t){o&&o.d(t),t&&u(e)}}}function be(t,e,n){let{buttons:o}=e;return t.$$set=t=>{"buttons"in t&&n(0,o=t.buttons)},[o]}class ze extends V{constructor(t){super(),K(this,t,be,ke,i,{buttons:0})}}function Ce(e){let n,o,s,i,l,r,d;return r=new ze({props:{buttons:[{name:"Close",onClick:e[2]},{name:"Copy to Clipboard",onClick:e[3]}]}}),{c(){n=f("div"),o=f("div"),o.textContent="Save export:",s=g(),i=f("textarea"),l=g(),W(r.$$.fragment),i.readOnly=!0,i.value=e[1],v(i,"class","svelte-z2ujem"),v(n,"class","container svelte-z2ujem")},m(t,e){c(t,n,e),a(n,o),a(n,s),a(n,i),a(n,l),H(r,n,null),d=!0},p:t,i(t){d||(R(r.$$.fragment,t),d=!0)},o(t){Y(r.$$.fragment,t),d=!1},d(t){t&&u(n),G(r)}}}function Me(e,n,o){let s,i=t,r=()=>(i(),i=l(a,(t=>o(4,s=t))),a);e.$$.on_destroy.push((()=>i()));let{window:a}=n;r();let c=(bt(),localStorage.getItem(vt));return e.$$set=t=>{"window"in t&&r(o(0,a=t.window))},e.$$.update=()=>{e.$$.dirty},[a,c,function(t){t.stopPropagation(),rt.windows.remove(a)},function(t){t.stopPropagation(),null!=c?(navigator.clipboard.writeText(c),rt.windows.create({panel:"information",title:"Done!",size:{x:300,y:"auto"},content:"Your save export has been placed in your clipboard."})):rt.windows.create({panel:"information",title:"Error!",size:{x:300,y:"auto"},content:"An unknown problem occured when trying to export your save."})},s]}class Se extends V{constructor(t){super(),K(this,t,Me,Ce,i,{window:0})}}function Ie(t){let e,n,o,s,i,l,r,d,p;return l=new ze({props:{buttons:[{name:"Close",onClick:t[2]},{name:"Import Save",onClick:t[3]}]}}),{c(){e=f("div"),n=f("div"),n.textContent="Save import:",o=g(),s=f("textarea"),i=g(),W(l.$$.fragment),v(s,"class","svelte-z2ujem"),v(e,"class","container svelte-z2ujem")},m(u,f){c(u,e,f),a(e,n),a(e,o),a(e,s),w(s,t[1]),a(e,i),H(l,e,null),r=!0,d||(p=h(s,"input",t[5]),d=!0)},p(t,[e]){2&e&&w(s,t[1])},i(t){r||(R(l.$$.fragment,t),r=!0)},o(t){Y(l.$$.fragment,t),r=!1},d(t){t&&u(e),G(l),d=!1,p()}}}function _e(e,n,o){let s,i=t,r=()=>(i(),i=l(a,(t=>o(4,s=t))),a);e.$$.on_destroy.push((()=>i()));let{window:a}=n;r();let c="";return e.$$set=t=>{"window"in t&&r(o(0,a=t.window))},e.$$.update=()=>{e.$$.dirty},[a,c,function(t){t.stopPropagation(),rt.windows.remove(a)},function(t){t.stopPropagation(),zt(c,!0)?rt.windows.create({panel:"information",title:"Save loaded",size:{x:300,y:"auto"},content:"Imported save loaded."}):rt.windows.create({panel:"information",title:"Error",size:{x:300,y:"auto"},content:"Failed to import your save."})},s,function(){c=this.value,o(1,c)}]}class Te extends V{constructor(t){super(),K(this,t,_e,Ie,i,{window:0})}}function Oe(t){let e,n,o,s,i,l,r=t[1].content+"";return i=new ze({props:{buttons:[{name:"Close",onClick:t[2]}]}}),{c(){e=f("div"),n=f("div"),o=p(r),s=g(),W(i.$$.fragment),v(e,"class","container svelte-1dcwpe7")},m(t,r){c(t,e,r),a(e,n),a(n,o),a(e,s),H(i,e,null),l=!0},p(t,[e]){(!l||2&e)&&r!==(r=t[1].content+"")&&$(o,r)},i(t){l||(R(i.$$.fragment,t),l=!0)},o(t){Y(i.$$.fragment,t),l=!1},d(t){t&&u(e),G(i)}}}function Ee(e,n,o){let s,i,r=t,a=()=>(r(),r=l(c,(t=>o(3,i=t))),c);e.$$.on_destroy.push((()=>r()));let{window:c}=n;return a(),e.$$set=t=>{"window"in t&&a(o(0,c=t.window))},e.$$.update=()=>{8&e.$$.dirty&&o(1,s=i)},[c,s,function(t){t.stopPropagation(),rt.windows.remove(c)},i]}class Be extends V{constructor(t){super(),K(this,t,Ee,Oe,i,{window:0})}}function qe(e){let n,o,s,i,l,r,d,m,h,w,x,k,b,z,C,M,S,I,_,T,O,E,B,q,A=st(e[1].damage)+"",P=Math.floor(1e3/e[1].attackInterval*100)/100+"",D=`translateX(${100-e[5]/e[1].attackInterval*100}%)`,N=`translateX(-${e[3]}%)`,j=st(e[1].healthCur)+"",X=st(e[1].healthMax)+"";return{c(){n=f("div"),o=f("div"),o.textContent="enemy",s=g(),i=f("div"),l=f("div"),r=g(),d=f("div"),m=p(A),h=g(),w=f("div"),x=f("div"),k=g(),b=f("div"),z=p(P),C=g(),M=f("div"),S=g(),I=f("div"),_=f("div"),T=g(),O=f("div"),E=p(j),B=p("/"),q=p(X),v(o,"class","name-type svelte-otslvo"),v(l,"class","stat-icon icon-itemstats icon-itemstats-attack svelte-otslvo"),v(d,"class","enemy-value svelte-otslvo"),v(i,"class","enemy-row svelte-otslvo"),v(x,"class","stat-icon icon-itemstats icon-itemstats-attackSpeed svelte-otslvo"),v(b,"class","enemy-value svelte-otslvo"),v(w,"class","enemy-row svelte-otslvo"),v(M,"class","attack-progress svelte-otslvo"),y(M,"transform",D,!1),v(_,"class","enemy-health svelte-otslvo"),y(_,"transform",N,!1),v(O,"class","enemy-health-text svelte-otslvo"),v(I,"class","enemy-fill svelte-otslvo"),v(n,"class","enemy svelte-otslvo")},m(t,u){c(t,n,u),a(n,o),a(n,s),a(n,i),a(i,l),a(i,r),a(i,d),a(d,m),a(n,h),a(n,w),a(w,x),a(w,k),a(w,b),a(b,z),a(n,C),a(n,M),a(n,S),a(n,I),a(I,_),a(I,T),a(I,O),a(O,E),a(O,B),a(O,q),e[6](n)},p(t,[e]){2&e&&A!==(A=st(t[1].damage)+"")&&$(m,A),2&e&&P!==(P=Math.floor(1e3/t[1].attackInterval*100)/100+"")&&$(z,P),34&e&&D!==(D=`translateX(${100-t[5]/t[1].attackInterval*100}%)`)&&y(M,"transform",D,!1),8&e&&N!==(N=`translateX(-${t[3]}%)`)&&y(_,"transform",N,!1),2&e&&j!==(j=st(t[1].healthCur)+"")&&$(E,j),2&e&&X!==(X=st(t[1].healthMax)+"")&&$(q,X)},i:t,o:t,d(t){t&&u(n),e[6](null)}}}function Ae(e,n,o){let s,i,r,a,c=t,u=()=>(c(),c=l(p,(t=>o(1,r=t))),p),d=t;e.$$.on_destroy.push((()=>c())),e.$$.on_destroy.push((()=>d()));let f,{enemy:p}=n;return u(),S((()=>(xt.get().elems.battleEnemies.set(p,f),()=>{}))),I((()=>{xt.get().elems.battleEnemies.delete(p)})),e.$$set=t=>{"enemy"in t&&u(o(0,p=t.enemy))},e.$$.update=()=>{2&e.$$.dirty&&(o(4,s=r.attackClock),d(),d=l(s,(t=>o(5,a=t)))),2&e.$$.dirty&&o(3,i=100-r.healthCur/r.healthMax*100)},[p,r,f,i,s,a,function(t){T[t?"unshift":"push"]((()=>{f=t,o(2,f)}))}]}class Pe extends V{constructor(t){super(),K(this,t,Ae,qe,i,{enemy:0})}}function De(t){let e,n;return e=new Pe({props:{enemy:t[1].enemy}}),{c(){W(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.enemy=t[1].enemy),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){Y(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Ne(t){let e,n,o,s=null!=t[1].enemy&&De(t);return{c(){e=f("div"),n=f("div"),s&&s.c(),v(n,"class","grid-cell-adjust svelte-ypt1cg"),v(e,"class","grid-cell svelte-ypt1cg")},m(t,i){c(t,e,i),a(e,n),s&&s.m(n,null),o=!0},p(t,[e]){null!=t[1].enemy?s?(s.p(t,e),2&e&&R(s,1)):(s=De(t),s.c(),R(s,1),s.m(n,null)):s&&(Q(),Y(s,1,1,(()=>{s=null})),U())},i(t){o||(R(s),o=!0)},o(t){Y(s),o=!1},d(t){t&&u(e),s&&s.d()}}}function je(e,n,o){let s,i=t,r=()=>(i(),i=l(a,(t=>o(1,s=t))),a);e.$$.on_destroy.push((()=>i()));let{cell:a}=n;return r(),e.$$set=t=>{"cell"in t&&r(o(0,a=t.cell))},[a,s]}class Xe extends V{constructor(t){super(),K(this,t,je,Ne,i,{cell:0})}}function Le(t,e,n){const o=t.slice();return o[2]=e[n],o}function Qe(t){let e,n;return e=new Xe({props:{cell:t[2]}}),{c(){W(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.cell=t[2]),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){Y(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Ue(t){let e,n,o=`repeat(${t[1].length}, ${100/t[1].length}%)`,s=t[1],i=[];for(let e=0;e<s.length;e+=1)i[e]=Qe(Le(t,s,e));const l=t=>Y(i[t],1,1,(()=>{i[t]=null}));return{c(){e=f("div");for(let t=0;t<i.length;t+=1)i[t].c();v(e,"class","grid-row svelte-15yw0nb"),y(e,"grid-template-columns",o,!1)},m(t,o){c(t,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,[n]){if(2&n){let o;for(s=t[1],o=0;o<s.length;o+=1){const l=Le(t,s,o);i[o]?(i[o].p(l,n),R(i[o],1)):(i[o]=Qe(l),i[o].c(),R(i[o],1),i[o].m(e,null))}for(Q(),o=s.length;o<i.length;o+=1)l(o);U()}2&n&&o!==(o=`repeat(${t[1].length}, ${100/t[1].length}%)`)&&y(e,"grid-template-columns",o,!1)},i(t){if(!n){for(let t=0;t<s.length;t+=1)R(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)Y(i[t]);n=!1},d(t){t&&u(e),d(i,t)}}}function Re(e,n,o){let s,i=t,r=()=>(i(),i=l(a,(t=>o(1,s=t))),a);e.$$.on_destroy.push((()=>i()));let{row:a}=n;return r(),e.$$set=t=>{"row"in t&&r(o(0,a=t.row))},[a,s]}class Ye extends V{constructor(t){super(),K(this,t,Re,Ue,i,{row:0})}}function Fe(t,e,n){const o=t.slice();return o[7]=e[n],o}function We(t){let e,n;return e=new Ye({props:{row:t[7]}}),{c(){W(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.row=t[7]),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){Y(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function He(t){let e,n,o,s=`${t[0]}px`,i=`flex: 0 0 ${t[0]}px`,l=`repeat(${t[1].length}, 64px)`,r=`${t[0]+64+64}px`,p=`translateY(${t[2]%1*64}px)`,g=t[1],m=[];for(let e=0;e<g.length;e+=1)m[e]=We(Fe(t,g,e));const h=t=>Y(m[t],1,1,(()=>{m[t]=null}));return{c(){e=f("div"),n=f("div");for(let t=0;t<m.length;t+=1)m[t].c();v(n,"class","grid svelte-1llcezi"),y(n,"width",s,!1),y(n,"flex",i,!1),y(n,"grid-template-rows",l,!1),v(e,"class","grid-stretch svelte-1llcezi"),y(e,"top","-64px",!1),y(e,"height",r,!1),y(e,"transform",p,!1)},m(t,s){c(t,e,s),a(e,n);for(let t=0;t<m.length;t+=1)m[t].m(n,null);o=!0},p(t,[o]){if(2&o){let e;for(g=t[1],e=0;e<g.length;e+=1){const s=Fe(t,g,e);m[e]?(m[e].p(s,o),R(m[e],1)):(m[e]=We(s),m[e].c(),R(m[e],1),m[e].m(n,null))}for(Q(),e=g.length;e<m.length;e+=1)h(e);U()}1&o&&s!==(s=`${t[0]}px`)&&y(n,"width",s,!1),1&o&&i!==(i=`flex: 0 0 ${t[0]}px`)&&y(n,"flex",i,!1),2&o&&l!==(l=`repeat(${t[1].length}, 64px)`)&&y(n,"grid-template-rows",l,!1),1&o&&r!==(r=`${t[0]+64+64}px`)&&y(e,"height",r,!1),4&o&&p!==(p=`translateY(${t[2]%1*64}px)`)&&y(e,"transform",p,!1)},i(t){if(!o){for(let t=0;t<g.length;t+=1)R(m[t]);o=!0}},o(t){m=m.filter(Boolean);for(let t=0;t<m.length;t+=1)Y(m[t]);o=!1},d(t){t&&u(e),d(m,t)}}}function Ge(t,e,n){let o,s,{battleWidth:i}=e;const{battle:l,player:a}=kt.get(),{grid:c}=l;r(t,c,(t=>n(1,o=t)));const{y:u}=a;return r(t,u,(t=>n(2,s=t))),I((()=>{xt.get().elems.battleEnemies.clear()})),t.$$set=t=>{"battleWidth"in t&&n(0,i=t.battleWidth)},t.$$.update=()=>{2&t.$$.dirty&&xt.get().elems.battleEnemies.clear()},[i,o,s,c,u]}class Je extends V{constructor(t){super(),K(this,t,Ge,He,i,{battleWidth:0})}}function Ke(t){let e,n,o,s,i,l,r,d,m,h,w,x,k,b,z,C,M,S,I,_,T,O,E,B,q,A,P=st(Math.floor(10*t[5])/10)+"",D=Math.floor(10*t[6])/10+"",N=`translateX(-${t[4]}%)`,j=st(t[2])+"",X=st(t[1])+"",L=`${t[7]}px`,Q=`${t[7]}px`,U=`0 0 ${t[7]}px`;return q=new Je({props:{battleWidth:t[7]}}),{c(){e=f("div"),n=f("div"),o=f("div"),s=p("Distance: "),i=p(P),l=g(),r=f("div"),d=p("Speed: "),m=p(D),h=g(),w=f("div"),x=f("div"),k=g(),b=f("div"),z=p(j),C=p("/"),M=p(X),S=g(),I=f("div"),I.textContent="HP",_=g(),T=f("div"),O=g(),E=f("div"),B=f("div"),W(q.$$.fragment),v(x,"class","healthbar-inner svelte-ssr6xk"),y(x,"transform",N,!1),v(b,"class","health svelte-ssr6xk"),v(I,"class","healthbar-text svelte-ssr6xk"),v(T,"class","healthbar-floating-text-hook svelte-ssr6xk"),v(w,"class","healthbar svelte-ssr6xk"),v(n,"class","info-container svelte-ssr6xk"),v(B,"class","grid-container svelte-ssr6xk"),y(B,"width",L,!1),y(B,"height",Q,!1),v(E,"class","grid-container-row svelte-ssr6xk"),y(E,"flex",U,!1),v(e,"class","container svelte-ssr6xk")},m(u,f){c(u,e,f),a(e,n),a(n,o),a(o,s),a(o,i),a(n,l),a(n,r),a(r,d),a(r,m),a(n,h),a(n,w),a(w,x),a(w,k),a(w,b),a(b,z),a(b,C),a(b,M),a(w,S),a(w,I),a(w,_),a(w,T),t[13](T),a(e,O),a(e,E),a(E,B),H(q,B,null),A=!0},p(t,[e]){(!A||32&e)&&P!==(P=st(Math.floor(10*t[5])/10)+"")&&$(i,P),(!A||64&e)&&D!==(D=Math.floor(10*t[6])/10+"")&&$(m,D),16&e&&N!==(N=`translateX(-${t[4]}%)`)&&y(x,"transform",N,!1),(!A||4&e)&&j!==(j=st(t[2])+"")&&$(z,j),(!A||2&e)&&X!==(X=st(t[1])+"")&&$(M,X)},i(t){A||(R(q.$$.fragment,t),A=!0)},o(t){Y(q.$$.fragment,t),A=!1},d(n){n&&u(e),t[13](null),G(q)}}}function Ve(e,n,o){let s,i,a,c,u,d,f=t,p=()=>(f(),f=l(g,(t=>o(12,c=t))),g);e.$$.on_destroy.push((()=>f()));let{window:g}=n;p();const{windows:m,player:h}=kt.get(),{y:v,speed:$,healthCur:w,healthMax:y}=h;let x;return r(e,v,(t=>o(5,u=t))),r(e,$,(t=>o(6,d=t))),r(e,w,(t=>o(2,a=t))),r(e,y,(t=>o(1,i=t))),S((()=>(xt.get().elems.playerHealth=x,()=>xt.get().elems.playerHealth=null))),e.$$set=t=>{"window"in t&&p(o(0,g=t.window))},e.$$.update=()=>{e.$$.dirty,6&e.$$.dirty&&o(4,s=100-a/i*100)},[g,i,a,x,s,u,d,384,v,$,w,y,c,function(t){T[t?"unshift":"push"]((()=>{x=t,o(3,x)}))}]}class Ze extends V{constructor(t){super(),K(this,t,Ve,Ke,i,{window:0})}}function tn(t,e,n){const o=t.slice();return o[5]=e[n],o[7]=n,o}function en(t){let e,n,o,s,i=`${$t.itemSize}px`,l=`${$t.itemSize}px`;return n=new ne({props:{id:"loot",slotIndex:t[7],slot:t[5]}}),{c(){e=f("div"),W(n.$$.fragment),o=g(),v(e,"class","slot-container svelte-qo3i7m"),y(e,"width",i,!1),y(e,"height",l,!1)},m(t,i){c(t,e,i),H(n,e,null),a(e,o),s=!0},p(t,e){const o={};2&e&&(o.slot=t[5]),n.$set(o)},i(t){s||(R(n.$$.fragment,t),s=!0)},o(t){Y(n.$$.fragment,t),s=!1},d(t){t&&u(e),G(n)}}}function nn(t){let e,n,o=t[1],s=[];for(let e=0;e<o.length;e+=1)s[e]=en(tn(t,o,e));const i=t=>Y(s[t],1,1,(()=>{s[t]=null}));return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=m()},m(t,o){for(let e=0;e<s.length;e+=1)s[e].m(t,o);c(t,e,o),n=!0},p(t,[n]){if(2&n){let l;for(o=t[1],l=0;l<o.length;l+=1){const i=tn(t,o,l);s[l]?(s[l].p(i,n),R(s[l],1)):(s[l]=en(i),s[l].c(),R(s[l],1),s[l].m(e.parentNode,e))}for(Q(),l=o.length;l<s.length;l+=1)i(l);U()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)R(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)Y(s[t]);n=!1},d(t){d(s,t),t&&u(e)}}}function on(e,n,o){let s,i,a=t,c=()=>(a(),a=l(u,(t=>o(3,s=t))),u);e.$$.on_destroy.push((()=>a()));let{window:u}=n;c();const{loot:d}=kt.get().inventories;return r(e,d,(t=>o(1,i=t))),e.$$set=t=>{"window"in t&&c(o(0,u=t.window))},e.$$.update=()=>{e.$$.dirty},[u,i,d,s]}class sn extends V{constructor(t){super(),K(this,t,on,nn,i,{window:0})}}function ln(t){let e,n,o,s,i;var l=t[4][t[3].panel];function r(t){return{props:{window:t[2]}}}return l&&(o=new l(r(t))),{c(){e=f("div"),n=f("div"),o&&W(o.$$.fragment),v(n,"class","panel-content svelte-191zzey"),A((()=>t[5].call(n))),v(e,"class","panel svelte-191zzey")},m(l,r){c(l,e,r),a(e,n),o&&H(o,n,null),s=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=f("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const o=b();let s;return o?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=h(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{s=h(n.contentWindow,"resize",e)}),a(t,n),()=>{(o||s&&n.contentWindow)&&s(),u(n)}}(n,t[5].bind(n)),i=!0},p(t,[e]){const s={};if(4&e&&(s.window=t[2]),l!==(l=t[4][t[3].panel])){if(o){Q();const t=o;Y(t.$$.fragment,1,0,(()=>{G(t,1)})),U()}l?(o=new l(r(t)),W(o.$$.fragment),R(o.$$.fragment,1),H(o,n,null)):o=null}else l&&o.$set(s)},i(t){i||(o&&R(o.$$.fragment,t),i=!0)},o(t){o&&Y(o.$$.fragment,t),i=!1},d(t){t&&u(e),o&&G(o),s()}}}function rn(e,n,o){let s,i,r=t,a=()=>(r(),r=l(c,(t=>o(3,i=t))),c);e.$$.on_destroy.push((()=>r()));let{window:c}=n;a();const u={backpack:re,equipment:me,debug:ue,save_export:Se,save_import:Te,information:Be,battle:Ze,loot:sn};let d=0;return e.$$set=t=>{"window"in t&&a(o(0,c=t.window))},e.$$.update=()=>{1&e.$$.dirty&&o(2,s=c)},[c,d,s,i,u,function(){d=this.clientWidth,o(1,d)}]}class an extends V{constructor(t){super(),K(this,t,rn,ln,i,{window:0})}}const{window:cn}=F;function un(e){let n,s,i,l,r,a,d,p,m,$,w,y,x,k,b,z,C,M,S;return{c(){n=f("div"),s=g(),i=f("div"),l=g(),r=f("div"),a=g(),d=f("div"),p=g(),m=f("div"),$=g(),w=f("div"),y=g(),x=f("div"),k=g(),b=f("div"),z=g(),C=f("div"),v(n,"class","resize svelte-19g66cg"),v(i,"class","border n svelte-19g66cg"),v(r,"class","border s svelte-19g66cg"),v(d,"class","border w svelte-19g66cg"),v(m,"class","border e svelte-19g66cg"),v(w,"class","border ne svelte-19g66cg"),v(x,"class","border nw svelte-19g66cg"),v(b,"class","border se svelte-19g66cg"),v(C,"class","border sw svelte-19g66cg")},m(t,o){c(t,n,o),c(t,s,o),c(t,i,o),c(t,l,o),c(t,r,o),c(t,a,o),c(t,d,o),c(t,p,o),c(t,m,o),c(t,$,o),c(t,w,o),c(t,y,o),c(t,x,o),c(t,k,o),c(t,b,o),c(t,z,o),c(t,C,o),M||(S=[h(i,"mousedown",e[20]),h(r,"mousedown",e[21]),h(d,"mousedown",e[22]),h(m,"mousedown",e[23]),h(w,"mousedown",e[24]),h(x,"mousedown",e[25]),h(b,"mousedown",e[26]),h(C,"mousedown",e[27])],M=!0)},p:t,d(t){t&&u(n),t&&u(s),t&&u(i),t&&u(l),t&&u(r),t&&u(a),t&&u(d),t&&u(p),t&&u(m),t&&u($),t&&u(w),t&&u(y),t&&u(x),t&&u(k),t&&u(b),t&&u(z),t&&u(C),M=!1,o(S)}}}function dn(t){let e,n,s,i,l,r,d,m,w,x,k,b,C,M,S,I=t[4].title+"";A(t[19]);let _=t[4].resizable&&un(t);return b=new an({props:{window:t[0]}}),{c(){e=f("div"),_&&_.c(),n=g(),s=f("div"),i=f("div"),l=p(I),r=g(),d=f("div"),m=f("div"),m.innerHTML='<div class="small-inner small-col-gray minimize svelte-19g66cg"></div>',w=g(),x=f("div"),x.innerHTML='<div class="small-inner small-col-red close svelte-19g66cg"></div>',k=g(),W(b.$$.fragment),v(i,"class","title svelte-19g66cg"),v(m,"class","small svelte-19g66cg"),v(x,"class","small svelte-19g66cg"),v(d,"class","side svelte-19g66cg"),v(s,"class","top svelte-19g66cg"),y(s,"flex","0 0 "+fn+"px"),z(s,"focused",t[9]),z(s,"unfocused",t[8]),v(e,"class","window svelte-19g66cg"),z(e,"focused",t[9]),z(e,"unfocused",t[8]),y(e,"display",t[4].minimized?"none":"initial",!1),y(e,"z-index",t[7],!1),y(e,"transform",`translate(${t[4].pos.x}px, ${t[4].pos.y}px)`,!1),y(e,"position","fixed",!1),y(e,"width",t[6],!1),y(e,"height",t[5],!1)},m(o,u){c(o,e,u),_&&_.m(e,null),a(e,n),a(e,s),a(s,i),a(i,l),a(s,r),a(s,d),a(d,m),a(d,w),a(d,x),a(e,k),H(b,e,null),t[28](e),C=!0,M||(S=[h(cn,"resize",t[19]),h(m,"click",t[13]),h(m,"mousedown",pn),h(x,"click",t[12]),h(x,"mousedown",pn),h(s,"mousedown",t[10]),h(e,"click",gn),h(e,"mousedown",t[11])],M=!0)},p(t,o){t[4].resizable?_?_.p(t,o):(_=un(t),_.c(),_.m(e,n)):_&&(_.d(1),_=null),(!C||16&o[0])&&I!==(I=t[4].title+"")&&$(l,I),(!C||512&o[0])&&z(s,"focused",t[9]),(!C||256&o[0])&&z(s,"unfocused",t[8]);const i={};1&o[0]&&(i.window=t[0]),b.$set(i),(!C||512&o[0])&&z(e,"focused",t[9]),(!C||256&o[0])&&z(e,"unfocused",t[8]),16&o[0]&&y(e,"display",t[4].minimized?"none":"initial",!1),128&o[0]&&y(e,"z-index",t[7],!1),16&o[0]&&y(e,"transform",`translate(${t[4].pos.x}px, ${t[4].pos.y}px)`,!1),64&o[0]&&y(e,"width",t[6],!1),32&o[0]&&y(e,"height",t[5],!1)},i(t){C||(R(b.$$.fragment,t),C=!0)},o(t){Y(b.$$.fragment,t),C=!1},d(n){n&&u(e),_&&_.d(),G(b),t[28](null),M=!1,o(S)}}}const fn=26;function pn(t){t.stopPropagation()}function gn(t){t.stopPropagation()}function mn(e,n,o){let s,i,r,a,c,u,d=t,f=()=>(d(),d=l(g,(t=>o(4,u=t))),g);e.$$.on_destroy.push((()=>d()));let p,{window:g}=n;f(),kt.get();let m=0,h=0,v=0,$=0,w=null,y=null;function x(t){t.stopPropagation(),t.preventDefault(),w&&(rt.windows.move(g,b(t.pageX-w.initialOffset.x,t.pageY-w.initialOffset.y)),o(17,w=null))}function k(t){if(t.stopPropagation(),t.preventDefault(),!w||!p)return;const e=b(t.pageX-w.initialOffset.x,t.pageY-w.initialOffset.y);o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p)}function b(t,e){let n=p.getBoundingClientRect(),o=Math.max(-n.width/2,t);o=Math.min(o,m-n.width/2);let s=Math.max(0,e);return s=Math.min(s,h-50),{x:o,y:s}}function z(t,e){if(0!==t.button)return;const n=p.getBoundingClientRect();o(18,y={from:e,initialRect:n,initialOffset:{x:t.pageX-n.left,y:t.pageY-n.top},initialMousePos:{x:t.pageX,y:t.pageY}}),t.preventDefault()}function C(t){if(t.stopPropagation(),t.preventDefault(),y&&p&&"number"==typeof u.size.x&&"number"==typeof u.size.y)if("nw"===y.from){const e=b(t.pageX-y.initialOffset.x,t.pageY-y.initialOffset.y),n=t.pageX-y.initialRect.x-y.initialOffset.x,s=t.pageY-y.initialRect.y-y.initialOffset.y;o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p),o(1,p.style.width=u.size.x-n+"px",p),o(1,p.style.height=u.size.y-s+"px",p)}else{if(y.from.includes("w")){const e=b(t.pageX-y.initialOffset.x,y.initialMousePos.y-y.initialOffset.y),n=t.pageX-y.initialRect.x-y.initialOffset.x;o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p),o(1,p.style.width=u.size.x-n+"px",p)}if(y.from.includes("e")){const e=t.pageX-y.initialMousePos.x;o(1,p.style.width=`${u.size.x+e}px`,p)}if(y.from.includes("n")){const e=b(y.initialMousePos.x-y.initialOffset.x,t.pageY-y.initialOffset.y),n=t.pageY-y.initialRect.y-y.initialOffset.y;o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p),o(1,p.style.height=u.size.y-n+"px",p)}if(y.from.includes("s")){const e=t.pageY-y.initialMousePos.y;o(1,p.style.height=`${u.size.y+e}px`,p)}}}function M(t){if(t.stopPropagation(),t.preventDefault(),y&&"number"==typeof u.size.x&&"number"==typeof u.size.y){if("nw"===y.from){const e=t.pageX-y.initialRect.x-y.initialOffset.x,n=t.pageY-y.initialRect.y-y.initialOffset.y;rt.windows.resize(g,{x:u.size.x-e,y:u.size.y-n}),rt.windows.move(g,b(t.pageX-y.initialOffset.x,t.pageY-y.initialOffset.y))}else{if(y.from.includes("w")){const e=t.pageX-y.initialRect.x-y.initialOffset.x;rt.windows.resize(g,{x:u.size.x-e,y:u.size.y}),rt.windows.move(g,b(t.pageX-y.initialOffset.x,y.initialMousePos.y-y.initialOffset.y))}if(y.from.includes("e")){const e=t.pageX-y.initialMousePos.x;rt.windows.resize(g,{x:u.size.x+e,y:u.size.y})}if(y.from.includes("n")){const e=t.pageY-y.initialRect.y-y.initialOffset.y;rt.windows.resize(g,{x:u.size.x,y:u.size.y-e}),rt.windows.move(g,b(y.initialMousePos.x-y.initialOffset.x,t.pageY-y.initialOffset.y))}if(y.from.includes("s")){const e=t.pageY-y.initialMousePos.y;rt.windows.resize(g,{x:u.size.x,y:u.size.y+e})}}o(18,y=null)}}S((()=>{}));return e.$$set=t=>{"window"in t&&f(o(0,g=t.window))},e.$$.update=()=>{if(16&e.$$.dirty[0]&&o(9,s=u.selected),16&e.$$.dirty[0]&&o(8,i=!u.selected),16&e.$$.dirty[0]&&o(7,r=u.selected?2:1),16&e.$$.dirty[0]&&o(6,a="auto"===u.size.x?u.size.x:u.size.x+"px"),16&e.$$.dirty[0]&&o(5,c="auto"===u.size.y?u.size.y:u.size.y+"px"),131072&e.$$.dirty[0]&&(w?(document.addEventListener("mousemove",k),document.addEventListener("mouseup",x)):(document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",x))),262144&e.$$.dirty[0]&&(y?(document.addEventListener("mousemove",C),document.addEventListener("mouseup",M)):(document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",M))),98335&e.$$.dirty[0]&&(m!=v||h!=$)){let t=p.getBoundingClientRect();const e=b(t.left,t.top);e.x==u.pos.x&&e.y==u.pos.y||(rt.windows.move(g,b(t.left,t.top)),o(1,p.style.transform=`translate(${e.x}px, ${e.y}px)`,p)),o(15,v=m),o(16,$=h)}},[g,p,m,h,u,c,a,r,i,s,function(t){if(0!==t.button)return;let e=p.getBoundingClientRect();o(17,w={initialOffset:{x:t.pageX-e.left,y:t.pageY-e.top}}),t.preventDefault()},function(t){0===t.button&&rt.windows.select(g,!0)},function(t){0===t.button&&(rt.windows.remove(g),t.preventDefault(),t.stopPropagation())},function(t){0===t.button&&(rt.windows.select(g,!1),rt.windows.minimize(g,!0),t.preventDefault(),t.stopPropagation())},z,v,$,w,y,function(){o(2,m=cn.innerWidth),o(3,h=cn.innerHeight)},t=>z(t,"n"),t=>z(t,"s"),t=>z(t,"w"),t=>z(t,"e"),t=>z(t,"ne"),t=>z(t,"nw"),t=>z(t,"se"),t=>z(t,"sw"),function(t){T[t?"unshift":"push"]((()=>{p=t,o(1,p),o(2,m),o(15,v),o(3,h),o(16,$),o(4,u),o(0,g)}))}]}class hn extends V{constructor(t){super(),K(this,t,mn,dn,i,{window:0},null,[-1,-1])}}function vn(t,e,n){const o=t.slice();return o[2]=e[n],o}function $n(t){let e,n;return e=new hn({props:{window:t[2]}}),{c(){W(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.window=t[2]),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){Y(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function wn(t){let e,n,o=t[0],s=[];for(let e=0;e<o.length;e+=1)s[e]=$n(vn(t,o,e));const i=t=>Y(s[t],1,1,(()=>{s[t]=null}));return{c(){e=f("div");for(let t=0;t<s.length;t+=1)s[t].c();v(e,"class","windows svelte-erncmc")},m(t,o){c(t,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){if(1&n){let l;for(o=t[0],l=0;l<o.length;l+=1){const i=vn(t,o,l);s[l]?(s[l].p(i,n),R(s[l],1)):(s[l]=$n(i),s[l].c(),R(s[l],1),s[l].m(e,null))}for(Q(),l=o.length;l<s.length;l+=1)i(l);U()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)R(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)Y(s[t]);n=!1},d(t){t&&u(e),d(s,t)}}}function yn(t,e,n){let o;const{windows:s}=kt.get();return r(t,s,(t=>n(0,o=t))),[o,s]}class xn extends V{constructor(t){super(),K(this,t,yn,wn,i,{})}}function kn(t){let e,n;return e=new Gt({props:{item:t[2],inventoryId:"cursor",slot:t[3],transparent:!1}}),{c(){W(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.item=t[2]),8&n&&(o.slot=t[3]),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){Y(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function bn(t){let e,n,o=`${t[0]+12}px`,s=`${t[1]+16}px`,i=null!=t[2]&&kn(t);return{c(){e=f("div"),i&&i.c(),v(e,"class","cursor-slot svelte-y592g2"),y(e,"left",o,!1),y(e,"top",s,!1)},m(t,o){c(t,e,o),i&&i.m(e,null),n=!0},p(t,[n]){null!=t[2]?i?(i.p(t,n),4&n&&R(i,1)):(i=kn(t),i.c(),R(i,1),i.m(e,null)):i&&(Q(),Y(i,1,1,(()=>{i=null})),U()),1&n&&o!==(o=`${t[0]+12}px`)&&y(e,"left",o,!1),2&n&&s!==(s=`${t[1]+16}px`)&&y(e,"top",s,!1)},i(t){n||(R(i),n=!0)},o(t){Y(i),n=!1},d(t){t&&u(e),i&&i.d()}}}function zn(e,n,o){let s,i,a,c,u=t;e.$$.on_destroy.push((()=>u()));const{cursor:d}=kt.get().inventories;r(e,d,(t=>o(6,c=t)));let f=0,p=0;return document.addEventListener("mousemove",(t=>{o(0,f=t.pageX),o(1,p=t.pageY)})),e.$$.update=()=>{64&e.$$.dirty&&(o(3,s=c[0]),u(),u=l(s,(t=>o(5,a=t)))),32&e.$$.dirty&&o(2,i=a.item)},[f,p,i,s,d,a,c]}class Cn extends V{constructor(t){super(),K(this,t,zn,bn,i,{})}}function Mn(e){let n,o,s,i,l,r;return{c(){n=f("div"),o=f("div"),s=f("div"),i=p(e[2]),v(s,"class","text svelte-129069q"),v(o,"class","inner svelte-129069q"),z(o,"selected",e[1]),v(n,"class","item svelte-129069q")},m(t,u){c(t,n,u),a(n,o),a(o,s),a(s,i),l||(r=h(o,"click",e[3]),l=!0)},p(t,[e]){4&e&&$(i,t[2]),2&e&&z(o,"selected",t[1])},i:t,o:t,d(t){t&&u(n),l=!1,r()}}}function Sn(e,n,o){let s,i,r,a=t,c=()=>(a(),a=l(u,(t=>o(4,r=t))),u);e.$$.on_destroy.push((()=>a())),kt.get();let{window:u}=n;return c(),e.$$set=t=>{"window"in t&&c(o(0,u=t.window))},e.$$.update=()=>{16&e.$$.dirty&&o(2,s=r.title),16&e.$$.dirty&&o(1,i=r.selected)},[u,i,s,function(t){i?(rt.windows.minimize(u,!0),rt.windows.select(u,!1)):(rt.windows.minimize(u,!1),rt.windows.select(u,!0)),t.stopPropagation()},r]}class In extends V{constructor(t){super(),K(this,t,Sn,Mn,i,{window:0})}}function _n(e){let n,s,i,l,r,d,p,m,$,w,y,x,k,b;return{c(){n=f("div"),s=f("div"),i=f("div"),i.textContent="Close all windows",l=g(),r=f("div"),d=f("div"),d.textContent="Save",p=g(),m=f("div"),$=f("div"),$.textContent="Export",w=g(),y=f("div"),x=f("div"),x.textContent="Import",v(i,"class","menu-item-inner svelte-431mug"),v(s,"class","menu-item svelte-431mug"),v(d,"class","menu-item-inner svelte-431mug"),v(r,"class","menu-item svelte-431mug"),v($,"class","menu-item-inner svelte-431mug"),v(m,"class","menu-item svelte-431mug"),v(x,"class","menu-item-inner svelte-431mug"),v(y,"class","menu-item svelte-431mug"),v(n,"class","menu svelte-431mug")},m(t,o){c(t,n,o),a(n,s),a(s,i),a(n,l),a(n,r),a(r,d),a(n,p),a(n,m),a(m,$),a(n,w),a(n,y),a(y,x),e[7](n),k||(b=[h(i,"click",e[3]),h(d,"click",e[4]),h($,"click",e[5]),h(x,"click",e[6])],k=!0)},p:t,d(t){t&&u(n),e[7](null),k=!1,o(b)}}}function Tn(e){let n,o,s,i,l,r,d=e[0]&&_n(e);return{c(){n=f("div"),o=f("div"),s=f("div"),s.textContent="Options",i=g(),d&&d.c(),v(s,"class","mainbtn-inner svelte-431mug"),v(o,"class","mainbtn svelte-431mug"),v(n,"class","left svelte-431mug")},m(t,u){c(t,n,u),a(n,o),a(o,s),a(n,i),d&&d.m(n,null),l||(r=h(s,"click",e[2]),l=!0)},p(t,[e]){t[0]?d?d.p(t,e):(d=_n(t),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},i:t,o:t,d(t){t&&u(n),d&&d.d(),l=!1,r()}}}function On(t,e,n){kt.get();let o,s=!1;return document.addEventListener("click",(function(){s&&n(0,s=!1),rt.windows.deselectAll()})),[s,o,function(t){n(0,s=!s),t.stopPropagation()},function(t){rt.windows.removeAll()},function(t){bt()},function(t){rt.windows.create({id:"save_export",panel:"save_export",size:{x:400,y:400},title:"Save Export"})},function(t){rt.windows.create({id:"save_import",panel:"save_import",size:{x:400,y:400},title:"Save Import"})},function(t){T[t?"unshift":"push"]((()=>{o=t,n(1,o)}))}]}class En extends V{constructor(t){super(),K(this,t,On,Tn,i,{})}}function Bn(t,e,n){const o=t.slice();return o[2]=e[n],o}function qn(t){let e,n;return e=new In({props:{window:t[2]}}),{c(){W(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.window=t[2]),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){Y(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function An(t){let e,n,o,s,i;n=new En({});let l=t[0],r=[];for(let e=0;e<l.length;e+=1)r[e]=qn(Bn(t,l,e));const p=t=>Y(r[t],1,1,(()=>{r[t]=null}));return{c(){e=f("div"),W(n.$$.fragment),o=g(),s=f("div");for(let t=0;t<r.length;t+=1)r[t].c();v(s,"class","middle svelte-1bpzds1"),v(e,"class","taskbar svelte-1bpzds1")},m(t,l){c(t,e,l),H(n,e,null),a(e,o),a(e,s);for(let t=0;t<r.length;t+=1)r[t].m(s,null);i=!0},p(t,[e]){if(1&e){let n;for(l=t[0],n=0;n<l.length;n+=1){const o=Bn(t,l,n);r[n]?(r[n].p(o,e),R(r[n],1)):(r[n]=qn(o),r[n].c(),R(r[n],1),r[n].m(s,null))}for(Q(),n=l.length;n<r.length;n+=1)p(n);U()}},i(t){if(!i){R(n.$$.fragment,t);for(let t=0;t<l.length;t+=1)R(r[t]);i=!0}},o(t){Y(n.$$.fragment,t),r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)Y(r[t]);i=!1},d(t){t&&u(e),G(n),d(r,t)}}}function Pn(t,e,n){let o;const{windows:s}=kt.get();return r(t,s,(t=>n(0,o=t))),[o,s]}class Dn extends V{constructor(t){super(),K(this,t,Pn,An,i,{})}}function Nn(e){let n,o,s,i,l=e[1].text+"",r=e[1].x-50+"px",d=e[3]-50+"px";return{c(){n=f("div"),o=f("div"),s=p(l),v(o,"class","text"),v(n,"class",i="floating-text "+e[1].stylingClass+" svelte-13e75s8"),y(n,"color",e[1].color,!1),y(n,"left",r,!1),y(n,"top",d,!1)},m(t,e){c(t,n,e),a(n,o),a(o,s)},p(t,[e]){2&e&&l!==(l=t[1].text+"")&&$(s,l),2&e&&i!==(i="floating-text "+t[1].stylingClass+" svelte-13e75s8")&&v(n,"class",i),2&e&&y(n,"color",t[1].color,!1),2&e&&r!==(r=t[1].x-50+"px")&&y(n,"left",r,!1),8&e&&d!==(d=t[3]-50+"px")&&y(n,"top",d,!1)},i:t,o:t,d(t){t&&u(n)}}}function jn(e,n,o){let s,i,r,a=t,c=()=>(a(),a=l(d,(t=>o(1,i=t))),d),u=t;e.$$.on_destroy.push((()=>a())),e.$$.on_destroy.push((()=>u()));let{floatingText:d}=n;return c(),e.$$set=t=>{"floatingText"in t&&c(o(0,d=t.floatingText))},e.$$.update=()=>{2&e.$$.dirty&&(o(2,s=i.y),u(),u=l(s,(t=>o(3,r=t))))},[d,i,s,r]}class Xn extends V{constructor(t){super(),K(this,t,jn,Nn,i,{floatingText:0})}}function Ln(t,e,n){const o=t.slice();return o[2]=e[n],o}function Qn(t){let e,n;return e=new Xn({props:{floatingText:t[2]}}),{c(){W(e.$$.fragment)},m(t,o){H(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.floatingText=t[2]),e.$set(o)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){Y(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Un(t){let e,n,o=t[0],s=[];for(let e=0;e<o.length;e+=1)s[e]=Qn(Ln(t,o,e));const i=t=>Y(s[t],1,1,(()=>{s[t]=null}));return{c(){e=f("div");for(let t=0;t<s.length;t+=1)s[t].c();v(e,"class","floating-text-container svelte-1j1f5xp")},m(t,o){c(t,e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){if(1&n){let l;for(o=t[0],l=0;l<o.length;l+=1){const i=Ln(t,o,l);s[l]?(s[l].p(i,n),R(s[l],1)):(s[l]=Qn(i),s[l].c(),R(s[l],1),s[l].m(e,null))}for(Q(),l=o.length;l<s.length;l+=1)i(l);U()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)R(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)Y(s[t]);n=!1},d(t){t&&u(e),d(s,t)}}}function Rn(t,e,n){let o;const s=xt.get().floatingText;return r(t,s,(t=>n(0,o=t))),[o,s]}class Yn extends V{constructor(t){super(),K(this,t,Rn,Un,i,{})}}function Fn(e){let n,o,s,i,l,r,d,p,m,h,$,w,y;return n=new At({}),i=new Ut({}),r=new Dn({}),p=new xn({}),h=new Yn({}),w=new Cn({}),{c(){W(n.$$.fragment),o=g(),s=f("div"),W(i.$$.fragment),l=g(),W(r.$$.fragment),d=g(),W(p.$$.fragment),m=g(),W(h.$$.fragment),$=g(),W(w.$$.fragment),v(s,"class","desktop svelte-r0tb1q")},m(t,e){H(n,t,e),c(t,o,e),c(t,s,e),H(i,s,null),a(s,l),H(r,s,null),c(t,d,e),H(p,t,e),c(t,m,e),H(h,t,e),c(t,$,e),H(w,t,e),y=!0},p:t,i(t){y||(R(n.$$.fragment,t),R(i.$$.fragment,t),R(r.$$.fragment,t),R(p.$$.fragment,t),R(h.$$.fragment,t),R(w.$$.fragment,t),y=!0)},o(t){Y(n.$$.fragment,t),Y(i.$$.fragment,t),Y(r.$$.fragment,t),Y(p.$$.fragment,t),Y(h.$$.fragment,t),Y(w.$$.fragment,t),y=!1},d(t){G(n,t),t&&u(o),t&&u(s),G(i),G(r),t&&u(d),G(p,t),t&&u(m),G(h,t),t&&u($),G(w,t)}}}function Wn(e){let n,o,s=e[0],l=Fn();return{c(){n=f("div"),l.c(),v(n,"class","app svelte-r0tb1q")},m(t,e){c(t,n,e),l.m(n,null),o=!0},p(e,[o]){1&o&&i(s,s=e[0])?(Q(),Y(l,1,1,t),U(),l=Fn(),l.c(),R(l,1),l.m(n,null)):l.p(e,o)},i(t){o||(R(l),o=!0)},o(t){Y(l),o=!1},d(t){t&&u(n),l.d(t)}}}function Hn(t,e,n){let o;r(t,kt,(t=>n(1,o=t)));let s={};return t.$$.update=()=>{2&t.$$.dirty&&(n(0,s={}),console.info("App reloaded."))},[s,o]}var Gn=new class extends V{constructor(t){super(),K(this,t,Hn,Wn,i,{})}}({target:document.body});return window.onunhandledrejection=t=>{console.error(t)},console.info("Starting game."),zt(),requestAnimationFrame(gt),Gn}();